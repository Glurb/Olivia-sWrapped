<!DOCTYPE html>
<!-- saved from url=(0043)https://fudgey.io/running-wrapped-2025.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olivia's Running Wrapped</title>
    <link href="./John&#39;s Running Wrapped_files/css2" rel="stylesheet">
    <script src="./John&#39;s Running Wrapped_files/mermaid.min.js.download"></script>
    <link rel="stylesheet" href="./John&#39;s Running Wrapped_files/leaflet.css">
    <script src="./John&#39;s Running Wrapped_files/leaflet.js.download"></script>
    <script src="./John&#39;s Running Wrapped_files/leaflet-heat.js.download"></script>
    <script src="./John&#39;s Running Wrapped_files/polyline.js.download"></script>
    <style>
        :root {
            --neon-green: #39FF14;
            --electric-blue: #00D4FF;
            --hot-pink: #FF2D92;
            --deep-purple: #6B0F6B;
            --midnight: #0a0a0f;
            --card-dark: #12121a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-snap-type: y mandatory;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--midnight);
            color: white;
            overflow-x: hidden;
        }

        .slide {
            min-height: 100vh;
            scroll-snap-align: start;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        /* Intro Slide */
        .intro {
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a2e 50%, #0a1a2e 100%);
        }

        .intro::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 30% 20%, rgba(57, 255, 20, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 70% 80%, rgba(255, 45, 146, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 30%, rgba(0, 212, 255, 0.08) 0%, transparent 30%);
            animation: pulse 8s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.1) rotate(5deg); opacity: 0.8; }
        }

        .intro-content {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .year-badge {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--neon-green);
            letter-spacing: 0.3em;
            margin-bottom: 1rem;
            animation: fadeInUp 1s ease-out;
        }

        .main-title {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(3rem, 12vw, 8rem);
            line-height: 0.9;
            margin-bottom: 1rem;
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        .main-title .running {
            display: block;
            background: linear-gradient(90deg, var(--neon-green), var(--electric-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-title .wrapped {
            display: block;
            background: linear-gradient(90deg, var(--hot-pink), var(--electric-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .intro-subtitle {
            font-size: 1.2rem;
            color: rgba(255,255,255,0.6);
            margin-top: 2rem;
            animation: fadeInUp 1s ease-out 0.4s both;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 3rem;
            animation: bounce 2s infinite;
        }

        .scroll-indicator span {
            display: block;
            width: 30px;
            height: 50px;
            border: 2px solid var(--neon-green);
            border-radius: 20px;
            position: relative;
        }

        .scroll-indicator span::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 10px;
            background: var(--neon-green);
            border-radius: 3px;
            animation: scrollAnim 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes scrollAnim {
            0% { opacity: 1; top: 8px; }
            100% { opacity: 0; top: 25px; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Big Number Slide */
        .big-number-slide {
            background: linear-gradient(180deg, #0a0a0f 0%, #1a0520 100%);
        }

        .big-stat {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--hot-pink);
            letter-spacing: 0.2em;
            text-transform: uppercase;
            margin-bottom: 1rem;
        }

        .stat-number {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(5rem, 20vw, 15rem);
            line-height: 1;
            background: linear-gradient(180deg, #fff 0%, rgba(255,255,255,0.4) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-unit {
            font-family: 'Outfit', sans-serif;
            font-size: clamp(1.5rem, 4vw, 3rem);
            font-weight: 300;
            color: rgba(255,255,255,0.5);
            margin-top: 0.5rem;
        }

        .stat-context {
            margin-top: 2rem;
            font-size: 1.1rem;
            color: rgba(255,255,255,0.7);
        }

        /* Grid Stats Slide */
        .grid-slide {
            background: linear-gradient(135deg, #0f0a1a 0%, #0a1520 100%);
        }

        .slide-title {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 3rem;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 900px;
            width: 100%;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: transform 0.3s, border-color 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--neon-green), var(--electric-blue));
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(57, 255, 20, 0.3);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .card-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2.5rem;
            color: var(--neon-green);
        }

        .card-label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.5rem;
        }

        /* Fun Facts Slide */
        .fun-facts-slide {
            background: linear-gradient(135deg, #150a20 0%, #0a1520 100%);
        }

        .fact-list {
            max-width: 700px;
            width: 100%;
        }

        .fact-item {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            padding: 1.5rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--electric-blue);
            transition: transform 0.3s;
        }

        .fact-item:hover {
            transform: translateX(10px);
        }

        .fact-item:nth-child(2) { border-left-color: var(--neon-green); }
        .fact-item:nth-child(3) { border-left-color: var(--hot-pink); }
        .fact-item:nth-child(4) { border-left-color: #FFD700; }
        .fact-item:nth-child(5) { border-left-color: #FF6B35; }

        .fact-emoji {
            font-size: 2.5rem;
            flex-shrink: 0;
        }

        .fact-content h3 {
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
            color: var(--neon-green);
        }

        .fact-content p {
            color: rgba(255,255,255,0.7);
            font-size: 1rem;
        }

        /* Equivalents Slide */
        .equivalents-slide {
            background: linear-gradient(180deg, #0a1015 0%, #15101a 100%);
        }

        .equiv-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            max-width: 1000px;
            width: 100%;
        }

        .equiv-card {
            background: linear-gradient(135deg, rgba(57, 255, 20, 0.1) 0%, rgba(0, 212, 255, 0.05) 100%);
            border: 1px solid rgba(57, 255, 20, 0.2);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            position: relative;
        }

        .equiv-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(135deg, var(--neon-green), var(--electric-blue));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .equiv-card:hover::before {
            opacity: 1;
        }

        .equiv-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .equiv-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2.5rem;
            color: var(--neon-green);
        }

        .equiv-label {
            color: rgba(255,255,255,0.7);
            margin-top: 0.5rem;
            font-size: 1rem;
        }

        .equiv-context {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.4);
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Heart Stats Slide */
        .heart-slide {
            background: linear-gradient(135deg, #1a0515 0%, #100a15 100%);
        }

        .heart-visual {
            position: relative;
            margin-bottom: 3rem;
        }

        .heart-icon {
            font-size: 8rem;
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            15% { transform: scale(1.15); }
            30% { transform: scale(1); }
            45% { transform: scale(1.1); }
        }

        .heart-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            max-width: 600px;
        }

        .heart-stat {
            background: rgba(255, 45, 146, 0.1);
            border: 1px solid rgba(255, 45, 146, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
        }

        .heart-stat-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2rem;
            color: var(--hot-pink);
        }

        .heart-stat-label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.3rem;
        }

        /* Monthly Breakdown */
        .monthly-slide {
            background: linear-gradient(180deg, #0a0f15 0%, #150f1a 100%);
        }

        .month-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 900px;
            position: relative;
        }

        .month-chart-container .slide-title {
            margin-bottom: 0;
            position: absolute;
            top: -150px;
        }

        .month-bars {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 0.5rem;
            height: 300px;
            max-width: 900px;
            width: 100%;
        }

        .month-bar {
            flex: 1;
            max-width: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .bar {
            width: 100%;
            background: linear-gradient(180deg, var(--neon-green) 0%, var(--electric-blue) 100%);
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: transform 0.3s;
        }

        .bar:hover {
            transform: scaleY(1.05);
            transform-origin: bottom;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--neon-green);
            white-space: nowrap;
        }

        .month-label {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
        }

        /* Outro Slide */
        .outro-slide {
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a2e 50%, #0a1a2e 100%);
        }

        .outro-content {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .outro-title {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(2rem, 6vw, 4rem);
            margin-bottom: 1rem;
        }

        .outro-title span {
            background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--hot-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .outro-subtitle {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 2rem;
        }

        .final-stat {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: linear-gradient(135deg, var(--neon-green), var(--electric-blue));
            border-radius: 50px;
            font-family: 'Space Mono', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: #000;
            margin: 0.5rem;
        }

        .pace-improvement {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(4rem, 12vw, 8rem);
            background: linear-gradient(180deg, var(--hot-pink) 0%, var(--neon-green) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 2rem 0;
        }

        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }

        /* PR Board Slide */
        .pr-board-slide {
            background: linear-gradient(135deg, #0a1520 0%, #1a0f25 100%);
        }

        .pr-board-container {
            max-width: 800px;
            width: 100%;
        }

        .pr-board-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .pr-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s, border-color 0.3s;
        }

        .pr-card:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 215, 0, 0.4);
        }

        .pr-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #FFD700, #FF8C00);
        }

        .pr-card.no-data::before {
            background: linear-gradient(90deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
        }

        .pr-card.no-data {
            opacity: 0.5;
        }

        .pr-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .pr-distance {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.8rem;
            background: linear-gradient(90deg, #FFD700, #FF8C00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .pr-card.no-data .pr-distance {
            background: linear-gradient(90deg, rgba(255,255,255,0.4), rgba(255,255,255,0.2));
            -webkit-background-clip: text;
            background-clip: text;
        }

        .pr-medal {
            font-size: 2rem;
        }

        .pr-time {
            font-family: 'Space Mono', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            text-align: center;
            margin: 0.5rem 0;
        }

        .pr-card.no-data .pr-time {
            color: rgba(255,255,255,0.3);
            font-size: 1.5rem;
        }

        .pr-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .pr-pace {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--neon-green);
        }

        .pr-date {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        .pr-goal {
            text-align: center;
            color: rgba(255,255,255,0.4);
            font-style: italic;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        @media (max-width: 768px) {
            .pr-board-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            .pr-card {
                padding: 1rem;
                border-radius: 12px;
            }
            .pr-card-header {
                margin-bottom: 0.5rem;
            }
            .pr-distance {
                font-size: 1.1rem;
            }
            .pr-time {
                font-size: 1.4rem;
                margin: 0.25rem 0;
            }
            .pr-medal {
                font-size: 1.2rem;
            }
            .pr-details {
                margin-top: 0.5rem;
                padding-top: 0.5rem;
            }
            .pr-pace {
                font-size: 0.75rem;
            }
            .pr-date {
                font-size: 0.7rem;
            }
            .pr-goal {
                font-size: 0.75rem;
                margin-top: 0.25rem;
            }
            .pr-card.no-data .pr-time {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .pr-board-grid {
                gap: 0.5rem;
            }
            .pr-card {
                padding: 0.75rem;
            }
            .pr-distance {
                font-size: 1rem;
            }
            .pr-time {
                font-size: 1.2rem;
            }
            .pr-medal {
                font-size: 1rem;
            }
            .pr-pace {
                font-size: 0.7rem;
            }
            .pr-date {
                font-size: 0.65rem;
            }
        }

        /* Power Stats Slide */
        .power-slide {
            background: linear-gradient(135deg, #0f1520 0%, #150a20 100%);
        }

        .power-meter {
            width: 100%;
            max-width: 500px;
            height: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .power-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--electric-blue), var(--neon-green), #FFD700);
            border-radius: 10px;
            animation: powerPulse 2s ease-in-out infinite;
        }

        @keyframes powerPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .power-comparison {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .power-item {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            text-align: center;
            min-width: 150px;
        }

        .power-item-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            color: var(--electric-blue);
        }

        .power-item-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
        }

        /* Navigation dots */
        .nav-dots {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            z-index: 100;
        }

        .nav-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-dot:hover, .nav-dot.active {
            background: var(--neon-green);
            transform: scale(1.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .slide { padding: 1rem; }
            .slide-title { font-size: 1.5rem; margin-bottom: 1.5rem; }

            /* Stats Grid - smaller cards */
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            .stat-card { padding: 1rem; border-radius: 12px; }
            .card-icon { font-size: 1.5rem; margin-bottom: 0.5rem; }
            .card-value { font-size: 1.5rem; }
            .card-label { font-size: 0.75rem; }

            /* Progress/Milestone cards */
            .progress-container { width: 100%; }
            .milestone-card { padding: 1.25rem; margin-bottom: 1rem; }
            .milestone-distance { font-size: 2rem; }
            .milestone-improvement { font-size: 0.85rem; padding: 0.4rem 0.8rem; }
            .time-comparison { flex-direction: column; gap: 0.5rem; }
            .time-box { padding: 1rem; }
            .time-value { font-size: 1.3rem; }
            .time-label { font-size: 0.7rem; }
            .arrow-container { transform: rotate(90deg); font-size: 1.5rem; }

            /* Equivalents grid */
            .equiv-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            .equiv-card { padding: 1rem; border-radius: 12px; }
            .equiv-emoji { font-size: 2rem; margin-bottom: 0.5rem; }
            .equiv-value { font-size: 1.5rem; }
            .equiv-label { font-size: 0.75rem; }
            .equiv-context { font-size: 0.7rem; }

            /* Heart stats */
            .heart-icon { font-size: 4rem; }
            .heart-stats-grid { gap: 0.75rem; }
            .heart-stat { padding: 1rem; }
            .heart-stat-value { font-size: 1.5rem; }
            .heart-stat-label { font-size: 0.75rem; }

            /* Power stats */
            .power-comparison { gap: 0.5rem; }
            .power-item { padding: 0.75rem; min-width: auto; }
            .power-item-value { font-size: 1.2rem; }

            /* Charts */
            .nav-dots { right: 0.5rem; }
            .nav-dot { width: 8px; height: 8px; }
            .month-bars { height: 180px; }
            .hour-bars { height: 180px; gap: 0.3rem; }
            .bar-value { font-size: 0.6rem; top: -20px; }

            /* Titles grid */
            .titles-grid { grid-template-columns: 1fr; }
            .title-card { padding: 1rem; }

            /* Outro */
            .pace-improvement { font-size: clamp(2.5rem, 10vw, 4rem); }
            .final-stat { padding: 0.6rem 1rem; font-size: 0.85rem; margin: 0.25rem; }
        }

        @media (max-width: 480px) {
            .slide { padding: 0.75rem; }
            .stats-grid { gap: 0.5rem; }
            .stat-card { padding: 0.75rem; }
            .card-value { font-size: 1.25rem; }
            .equiv-grid { gap: 0.5rem; }
            .equiv-card { padding: 0.75rem; }
            .equiv-value { font-size: 1.25rem; }
            .milestone-card { padding: 1rem; }
            .milestone-distance { font-size: 1.5rem; }
            .time-value { font-size: 1.1rem; }
        }

        /* Hour Start Times Slide */
        .hour-slide {
            background: linear-gradient(135deg, #0a1520 0%, #1a0a15 100%);
        }

        .hour-slide .slide-title {
            margin-bottom: 2rem;
        }

        .hour-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 900px;
        }

        .hour-bars {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 0.5rem;
            height: 300px;
            max-width: 900px;
            width: 100%;
        }

        .hour-bar {
            flex: 1;
            max-width: 50px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hour-bar .bar {
            background: linear-gradient(180deg, var(--hot-pink) 0%, var(--electric-blue) 100%);
        }

        .hour-bar.morning .bar {
            background: linear-gradient(180deg, #FFD700 0%, #FF8C00 100%);
        }

        .hour-bar.early .bar {
            background: linear-gradient(180deg, var(--neon-green) 0%, #00ff88 100%);
        }

        /* Shoes Slide */
        .shoes-slide {
            background: linear-gradient(135deg, #0a1015 0%, #1a100a 100%);
        }

        .shoes-container {
            max-width: 800px;
            width: 100%;
        }

        .shoes-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .shoe-card {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.25rem 1.5rem;
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s, border-color 0.3s;
        }

        .shoe-card:hover {
            transform: translateX(10px);
            border-color: rgba(255, 165, 0, 0.4);
        }

        .shoe-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #FF8C00, #FFD700);
        }

        .shoe-card:nth-child(1)::before { background: linear-gradient(180deg, #FFD700, #FF8C00); }
        .shoe-card:nth-child(2)::before { background: linear-gradient(180deg, #C0C0C0, #A0A0A0); }
        .shoe-card:nth-child(3)::before { background: linear-gradient(180deg, #CD7F32, #8B4513); }
        .shoe-card:nth-child(4)::before { background: linear-gradient(180deg, #39FF14, #00D4FF); }
        .shoe-card:nth-child(5)::before { background: linear-gradient(180deg, #FF2D92, #FF6B35); }
        .shoe-card:nth-child(6)::before { background: linear-gradient(180deg, #00D4FF, #6B0F6B); }

        .shoe-rank {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            color: rgba(255,255,255,0.3);
            min-width: 40px;
            text-align: center;
        }

        .shoe-card:nth-child(1) .shoe-rank { color: #FFD700; }
        .shoe-card:nth-child(2) .shoe-rank { color: #C0C0C0; }
        .shoe-card:nth-child(3) .shoe-rank { color: #CD7F32; }

        .shoe-icon {
            font-size: 2.5rem;
            flex-shrink: 0;
        }

        .shoe-info {
            flex: 1;
            min-width: 0;
        }

        .shoe-name {
            font-family: 'Outfit', sans-serif;
            font-weight: 600;
            font-size: 1.1rem;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .shoe-km {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.25rem;
        }

        .shoe-bar-container {
            flex: 1;
            max-width: 200px;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .shoe-bar {
            height: 100%;
            border-radius: 4px;
            background: linear-gradient(90deg, #FF8C00, #FFD700);
            transition: width 0.5s ease-out;
        }

        .shoe-card:nth-child(1) .shoe-bar { background: linear-gradient(90deg, #FFD700, #FF8C00); }
        .shoe-card:nth-child(2) .shoe-bar { background: linear-gradient(90deg, #C0C0C0, #E8E8E8); }
        .shoe-card:nth-child(3) .shoe-bar { background: linear-gradient(90deg, #CD7F32, #DDA15E); }
        .shoe-card:nth-child(4) .shoe-bar { background: linear-gradient(90deg, #39FF14, #00D4FF); }
        .shoe-card:nth-child(5) .shoe-bar { background: linear-gradient(90deg, #FF2D92, #FF6B35); }
        .shoe-card:nth-child(6) .shoe-bar { background: linear-gradient(90deg, #00D4FF, #6B0F6B); }

        .shoe-distance {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.3rem;
            color: #FFD700;
            min-width: 80px;
            text-align: right;
        }

        .shoe-card:nth-child(2) .shoe-distance { color: #C0C0C0; }
        .shoe-card:nth-child(3) .shoe-distance { color: #CD7F32; }
        .shoe-card:nth-child(4) .shoe-distance { color: #39FF14; }
        .shoe-card:nth-child(5) .shoe-distance { color: #FF2D92; }
        .shoe-card:nth-child(6) .shoe-distance { color: #00D4FF; }

        @media (max-width: 768px) {
            .shoe-card {
                padding: 1rem;
                gap: 0.75rem;
            }
            .shoe-icon { font-size: 1.8rem; }
            .shoe-rank { font-size: 1.2rem; min-width: 30px; }
            .shoe-name { font-size: 0.95rem; }
            .shoe-km { font-size: 0.8rem; }
            .shoe-bar-container { display: none; }
            .shoe-distance { font-size: 1.1rem; min-width: 60px; }
        }

        /* Airtime Slide */
        .airtime-slide {
            background: linear-gradient(180deg, #0a0a1a 0%, #1a0a2a 50%, #0a1a2a 100%);
            overflow: hidden;
        }

        .airtime-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            position: relative;
            z-index: 1;
        }

        .airtime-visual {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .airtime-circle {
            position: absolute;
            width: 250px;
            height: 250px;
            border-radius: 50%;
            border: 2px solid rgba(0, 212, 255, 0.2);
            animation: pulseRing 3s ease-in-out infinite;
        }

        .airtime-circle:nth-child(2) {
            width: 200px;
            height: 200px;
            animation-delay: 0.5s;
        }

        .airtime-circle:nth-child(3) {
            width: 150px;
            height: 150px;
            animation-delay: 1s;
        }

        @keyframes pulseRing {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.6; }
        }

        .runner-container {
            position: relative;
            z-index: 2;
        }

        .runner-figure {
            font-size: 5rem;
            animation: runnerFloat 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(57, 255, 20, 0.5));
        }

        @keyframes runnerFloat {
            0%, 100% {
                transform: translateY(30px) scale(0.95);
                filter: drop-shadow(0 5px 10px rgba(57, 255, 20, 0.3));
            }
            50% {
                transform: translateY(-30px) scale(1);
                filter: drop-shadow(0 30px 30px rgba(57, 255, 20, 0.1));
            }
        }

        .ground-line {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 4px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            border-radius: 2px;
        }

        .ground-shadow {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 10px;
            background: radial-gradient(ellipse, rgba(0,0,0,0.4) 0%, transparent 70%);
            animation: shadowPulse 2s ease-in-out infinite;
        }

        @keyframes shadowPulse {
            0%, 100% {
                width: 80px;
                opacity: 0.6;
            }
            50% {
                width: 40px;
                opacity: 0.2;
            }
        }

        .airtime-stats {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
            max-width: 700px;
        }

        .airtime-stat {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 16px;
            padding: 1.5rem 2rem;
            text-align: center;
            min-width: 150px;
            position: relative;
            overflow: hidden;
        }

        .airtime-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--electric-blue), var(--neon-green));
        }

        .airtime-stat-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2rem;
            background: linear-gradient(180deg, #00D4FF 0%, #39FF14 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .airtime-stat-label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.25rem;
        }

        .airtime-big-stat {
            text-align: center;
            margin-bottom: 1rem;
        }

        .airtime-big-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(3rem, 10vw, 6rem);
            background: linear-gradient(180deg, #00D4FF 0%, #39FF14 50%, #FFD700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .airtime-big-label {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--electric-blue);
            letter-spacing: 0.2em;
            text-transform: uppercase;
            margin-top: 0.5rem;
        }

        .airtime-fun-fact {
            background: linear-gradient(135deg, rgba(57, 255, 20, 0.1) 0%, rgba(0, 212, 255, 0.1) 100%);
            border: 1px solid rgba(57, 255, 20, 0.2);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-top: 1rem;
            text-align: center;
            max-width: 500px;
        }

        .airtime-fun-fact p {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        .airtime-fun-fact strong {
            color: var(--neon-green);
        }

        /* Floating particles for airtime slide */
        .airtime-particles {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--electric-blue);
            border-radius: 50%;
            opacity: 0.5;
            animation: floatParticle 8s linear infinite;
        }

        .particle:nth-child(1) { left: 10%; animation-delay: 0s; animation-duration: 7s; }
        .particle:nth-child(2) { left: 20%; animation-delay: 1s; animation-duration: 9s; }
        .particle:nth-child(3) { left: 30%; animation-delay: 2s; animation-duration: 6s; }
        .particle:nth-child(4) { left: 40%; animation-delay: 0.5s; animation-duration: 8s; }
        .particle:nth-child(5) { left: 50%; animation-delay: 1.5s; animation-duration: 10s; }
        .particle:nth-child(6) { left: 60%; animation-delay: 2.5s; animation-duration: 7s; }
        .particle:nth-child(7) { left: 70%; animation-delay: 0.8s; animation-duration: 9s; }
        .particle:nth-child(8) { left: 80%; animation-delay: 1.8s; animation-duration: 6s; }
        .particle:nth-child(9) { left: 90%; animation-delay: 2.2s; animation-duration: 8s; }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .airtime-visual {
                width: 200px;
                height: 200px;
            }
            .airtime-circle {
                width: 180px;
                height: 180px;
            }
            .airtime-circle:nth-child(2) {
                width: 140px;
                height: 140px;
            }
            .airtime-circle:nth-child(3) {
                width: 100px;
                height: 100px;
            }
            .runner-figure {
                font-size: 3.5rem;
            }
            .airtime-stats {
                gap: 0.75rem;
            }
            .airtime-stat {
                padding: 1rem;
                min-width: 120px;
            }
            .airtime-stat-value {
                font-size: 1.5rem;
            }
            .airtime-big-value {
                font-size: 3rem;
            }
        }

        /* Outrun Slide */
        .outrun-slide {
            background: linear-gradient(135deg, #1a0a0a 0%, #0a1a0a 100%);
        }

        .outrun-container {
            max-width: 700px;
            width: 100%;
        }

        .outrun-pace-display {
            text-align: center;
            margin-bottom: 2rem;
        }

        .outrun-pace-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 3rem;
            color: var(--neon-green);
        }

        .outrun-pace-label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.5);
            margin-top: 0.25rem;
        }

        .outrun-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .outrun-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border-left: 4px solid;
            transition: transform 0.3s;
        }

        .outrun-item:hover {
            transform: translateX(5px);
        }

        .outrun-item.can-outrun {
            border-left-color: var(--neon-green);
        }

        .outrun-item.cannot-outrun {
            border-left-color: var(--hot-pink);
        }

        .outrun-item.close-call {
            border-left-color: #FFD700;
        }

        .outrun-emoji {
            font-size: 2rem;
            flex-shrink: 0;
            width: 50px;
            text-align: center;
        }

        .outrun-info {
            flex: 1;
        }

        .outrun-name {
            font-weight: 600;
            font-size: 1rem;
            color: white;
        }

        .outrun-speed {
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            margin-top: 0.15rem;
        }

        .outrun-result {
            font-family: 'Archivo Black', sans-serif;
            font-size: 0.9rem;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            flex-shrink: 0;
        }

        .outrun-item.can-outrun .outrun-result {
            background: rgba(57, 255, 20, 0.2);
            color: var(--neon-green);
        }

        .outrun-item.cannot-outrun .outrun-result {
            background: rgba(255, 45, 146, 0.2);
            color: var(--hot-pink);
        }

        .outrun-item.close-call .outrun-result {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
        }

        @media (max-width: 768px) {
            .outrun-pace-value {
                font-size: 2rem;
            }
            .outrun-item {
                padding: 0.75rem 1rem;
            }
            .outrun-emoji {
                font-size: 1.5rem;
                width: 40px;
            }
            .outrun-name {
                font-size: 0.9rem;
            }
            .outrun-speed {
                font-size: 0.7rem;
            }
            .outrun-result {
                font-size: 0.75rem;
                padding: 0.3rem 0.6rem;
            }
        }

        /* Sweat Equity Slide */
        .sweat-slide {
            background: linear-gradient(180deg, #0a1520 0%, #1a2030 50%, #0a1015 100%);
        }

        .sweat-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            max-width: 800px;
        }

        .sweat-big-stat {
            text-align: center;
        }

        .sweat-big-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(4rem, 12vw, 8rem);
            background: linear-gradient(180deg, #00D4FF 0%, #0088AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .sweat-big-label {
            font-family: 'Space Mono', monospace;
            font-size: 1.2rem;
            color: #00D4FF;
            letter-spacing: 0.1em;
            margin-top: 0.5rem;
        }

        .sweat-visual {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 0.5rem;
            height: 150px;
            padding: 1rem;
        }

        .sweat-drop {
            font-size: 2rem;
            animation: sweatDrip 2s ease-in-out infinite;
            opacity: 0.8;
        }

        .sweat-drop:nth-child(1) { animation-delay: 0s; }
        .sweat-drop:nth-child(2) { animation-delay: 0.3s; }
        .sweat-drop:nth-child(3) { animation-delay: 0.6s; }
        .sweat-drop:nth-child(4) { animation-delay: 0.9s; }
        .sweat-drop:nth-child(5) { animation-delay: 1.2s; }

        @keyframes sweatDrip {
            0%, 100% { transform: translateY(0); opacity: 0.8; }
            50% { transform: translateY(20px); opacity: 0.4; }
        }

        .sweat-comparisons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            width: 100%;
            max-width: 600px;
        }

        .sweat-comparison {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
        }

        .sweat-comparison-emoji {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .sweat-comparison-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            color: #00D4FF;
        }

        .sweat-comparison-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.25rem;
        }

        .sweat-note {
            text-align: center;
            color: rgba(255,255,255,0.4);
            font-size: 0.85rem;
            font-style: italic;
            max-width: 400px;
        }

        @media (max-width: 768px) {
            .sweat-big-value {
                font-size: 3.5rem;
            }
            .sweat-comparisons {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            .sweat-comparison {
                padding: 1rem;
            }
            .sweat-comparison-emoji {
                font-size: 2rem;
            }
            .sweat-comparison-value {
                font-size: 1.2rem;
            }
        }

        /* Running Persona Slide */
        .persona-slide {
            background: linear-gradient(135deg, #1a0a30 0%, #0a1a25 50%, #150520 100%);
        }

        .persona-slide::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background:
                radial-gradient(circle at 30% 30%, rgba(255, 45, 146, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(57, 255, 20, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(0, 212, 255, 0.05) 0%, transparent 50%);
            animation: personaPulse 10s ease-in-out infinite;
        }

        @keyframes personaPulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
            50% { transform: scale(1.05) rotate(3deg); opacity: 1; }
        }

        .persona-container {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 700px;
            gap: 1.5rem;
        }

        .persona-reveal {
            animation: personaReveal 1s ease-out;
        }

        @keyframes personaReveal {
            0% { opacity: 0; transform: translateY(30px) scale(0.9); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .persona-emoji {
            font-size: 5rem;
            animation: personaFloat 3s ease-in-out infinite;
            filter: drop-shadow(0 0 30px rgba(255, 45, 146, 0.5));
        }

        @keyframes personaFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .persona-name {
            font-family: 'Archivo Black', sans-serif;
            font-size: clamp(2rem, 8vw, 4rem);
            background: linear-gradient(135deg, var(--hot-pink) 0%, var(--electric-blue) 50%, var(--neon-green) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.1;
            text-transform: uppercase;
        }

        .persona-tagline {
            font-family: 'Space Mono', monospace;
            font-size: 1.1rem;
            color: var(--electric-blue);
            letter-spacing: 0.05em;
            margin-top: -0.5rem;
        }

        .persona-traits {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            margin: 0.5rem 0;
        }

        .persona-trait {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 0.5rem 1.25rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .persona-trait:nth-child(1) {
            border-color: rgba(255, 45, 146, 0.5);
            background: rgba(255, 45, 146, 0.1);
        }

        .persona-trait:nth-child(2) {
            border-color: rgba(0, 212, 255, 0.5);
            background: rgba(0, 212, 255, 0.1);
        }

        .persona-trait:nth-child(3) {
            border-color: rgba(57, 255, 20, 0.5);
            background: rgba(57, 255, 20, 0.1);
        }

        .persona-description {
            font-size: 1.1rem;
            line-height: 1.7;
            color: rgba(255, 255, 255, 0.85);
            max-width: 600px;
        }

        .persona-spirit-animal {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 1rem 1.5rem;
            margin-top: 0.5rem;
        }

        .spirit-animal-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .spirit-animal-value {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .persona-generated {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.3);
            font-style: italic;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .persona-emoji {
                font-size: 4rem;
            }
            .persona-name {
                font-size: 2rem;
            }
            .persona-tagline {
                font-size: 0.95rem;
            }
            .persona-traits {
                gap: 0.5rem;
            }
            .persona-trait {
                padding: 0.4rem 1rem;
                font-size: 0.8rem;
            }
            .persona-description {
                font-size: 1rem;
            }
            .persona-spirit-animal {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
        }

        /* Confetti */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }

        .confetti.active {
            animation: confettiFall 4s ease-out forwards;
        }

        @keyframes confettiFall {
            0% {
                opacity: 1;
                transform: translateY(-100px) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) rotate(720deg);
            }
        }

        /* Run Titles Slide */
        .titles-slide {
            background: linear-gradient(135deg, #150a20 0%, #0a1520 100%);
        }

        .titles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            max-width: 1000px;
            width: 100%;
        }

        .title-card {
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            padding: 1.2rem;
            border-left: 4px solid var(--neon-green);
            transition: transform 0.3s;
        }

        .title-card:hover {
            transform: translateX(5px);
        }

        .title-card:nth-child(2) { border-left-color: var(--electric-blue); }
        .title-card:nth-child(3) { border-left-color: var(--hot-pink); }
        .title-card:nth-child(4) { border-left-color: #FFD700; }
        .title-card:nth-child(5) { border-left-color: #FF6B35; }
        .title-card:nth-child(6) { border-left-color: #00ff88; }

        .title-card-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.5rem;
        }

        .title-emoji {
            font-size: 1.8rem;
        }

        .title-category {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .title-name {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--neon-green);
            margin-bottom: 0.3rem;
        }

        .title-details {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
        }

        /* Music Slide */
        .music-slide {
            background: linear-gradient(135deg, #1a0a20 0%, #0a151a 100%);
        }

        .tracks-list {
            max-width: 600px;
            width: 100%;
        }

        .track-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            margin-bottom: 0.8rem;
            transition: transform 0.3s;
        }

        .track-item:hover {
            transform: translateX(5px);
        }

        .track-rank {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            color: var(--hot-pink);
            min-width: 30px;
        }

        .track-info {
            flex: 1;
        }

        .track-name {
            font-weight: 600;
            font-size: 1rem;
            color: white;
            margin-bottom: 0.2rem;
        }

        .track-artist {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        .track-plays {
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: var(--neon-green);
        }

        .play-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: var(--hot-pink);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .play-btn:hover {
            background: var(--neon-green);
            transform: scale(1.1);
        }

        .play-btn.playing {
            background: var(--neon-green);
        }

        .play-btn svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* Year Selector */
        .year-selector {
            margin-bottom: 1.5rem;
            animation: fadeInUp 1s ease-out;
        }

        .year-selector select {
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--neon-green);
            border-radius: 50px;
            padding: 0.75rem 2rem;
            font-family: 'Space Mono', monospace;
            font-size: 1.1rem;
            color: var(--neon-green);
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2339FF14' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1rem;
            padding-right: 3rem;
        }

        .year-selector select:hover {
            background-color: rgba(57, 255, 20, 0.1);
            box-shadow: 0 0 20px rgba(57, 255, 20, 0.3);
        }

        .year-selector select:focus {
            box-shadow: 0 0 30px rgba(57, 255, 20, 0.5);
        }

        .year-selector select option {
            background: var(--midnight);
            color: white;
            padding: 0.5rem;
        }

        /* How it works button */
        .how-it-works-btn {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            color: rgba(255,255,255,0.6);
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 99;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .how-it-works-btn:hover {
            background: rgba(57, 255, 20, 0.1);
            border-color: var(--neon-green);
            color: var(--neon-green);
        }

        /* Architecture Modal */
        .arch-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            overflow-y: auto;
            padding: 2rem;
        }

        .arch-modal.active {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .arch-modal-content {
            background: var(--card-dark);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            max-width: 900px;
            width: 100%;
            padding: 2rem;
            position: relative;
            margin: 2rem 0;
        }

        .arch-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: rgba(255,255,255,0.5);
            font-size: 2rem;
            cursor: pointer;
            transition: color 0.3s;
            line-height: 1;
        }

        .arch-modal-close:hover {
            color: var(--hot-pink);
        }

        .arch-modal h2 {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(90deg, var(--neon-green), var(--electric-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .arch-modal h3 {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--hot-pink);
            margin: 2rem 0 1rem 0;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .arch-diagram {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            padding: 1.5rem;
            overflow-x: auto;
            display: flex;
            justify-content: center;
        }

        .arch-diagram .mermaid {
            margin: 0;
            background: transparent;
            width: 100%;
        }

        .arch-diagram svg {
            max-width: 100%;
            height: auto;
        }

        .arch-step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            margin-bottom: 0.75rem;
            border-left: 3px solid var(--neon-green);
        }

        .arch-step:nth-child(2) { border-left-color: var(--electric-blue); }
        .arch-step:nth-child(3) { border-left-color: var(--hot-pink); }
        .arch-step:nth-child(4) { border-left-color: #FFD700; }
        .arch-step:nth-child(5) { border-left-color: #1db954; }
        .arch-step:nth-child(6) { border-left-color: #ff6b35; }

        .arch-step-num {
            background: linear-gradient(135deg, var(--neon-green), var(--electric-blue));
            color: #000;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .arch-step-content h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
            color: white;
        }

        .arch-step-content p {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
            margin: 0;
        }

        .tech-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .tech-tag {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 50px;
            padding: 0.4rem 0.8rem;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.7);
        }

        /* HR Zone Slide */
        .hr-zone-slide {
            background: linear-gradient(135deg, #1a0a20 0%, #200a15 100%);
        }

        .hr-zone-container {
            max-width: 800px;
            width: 100%;
        }

        .hr-zone-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .hr-zone-heart {
            font-size: 3rem;
            animation: heartbeat 1.5s infinite;
        }

        .hr-zone-max {
            text-align: center;
        }

        .hr-zone-max-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2.5rem;
            color: var(--hot-pink);
        }

        .hr-zone-max-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
        }

        .hr-zone-bars {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-bottom: 2rem;
        }

        .hr-zone-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .hr-zone-label {
            width: 100px;
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.7);
            text-align: right;
            flex-shrink: 0;
        }

        .hr-zone-label small {
            display: block;
            font-size: 0.65rem;
            color: rgba(255,255,255,0.4);
        }

        .hr-zone-track {
            flex: 1;
            height: 36px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .hr-zone-fill {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            transition: width 1s ease-out;
            min-width: fit-content;
        }

        .hr-zone-fill.z1 {
            background: linear-gradient(90deg, #4A90D9, #63B3ED);
        }

        .hr-zone-fill.z2 {
            background: linear-gradient(90deg, #48BB78, #68D391);
        }

        .hr-zone-fill.z3 {
            background: linear-gradient(90deg, #ECC94B, #F6E05E);
        }

        .hr-zone-fill.z4 {
            background: linear-gradient(90deg, #ED8936, #F6AD55);
        }

        .hr-zone-fill.z5 {
            background: linear-gradient(90deg, #E53E3E, #FC8181);
        }

        .hr-zone-stats {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: #000;
            font-weight: 700;
            white-space: nowrap;
        }

        .hr-zone-info {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            padding: 1.5rem;
            background: rgba(255, 45, 146, 0.05);
            border: 1px solid rgba(255, 45, 146, 0.2);
            border-radius: 16px;
        }

        .hr-zone-info-item {
            text-align: center;
        }

        .hr-zone-info-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.3rem;
            color: var(--hot-pink);
        }

        .hr-zone-info-label {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
            margin-top: 0.25rem;
        }

        @media (max-width: 768px) {
            .hr-zone-label {
                width: 70px;
                font-size: 0.7rem;
            }
            .hr-zone-label small {
                display: none;
            }
            .hr-zone-track {
                height: 32px;
            }
            .hr-zone-stats {
                font-size: 0.65rem;
            }
            .hr-zone-header {
                flex-direction: column;
                gap: 0.5rem;
            }
            .hr-zone-heart {
                font-size: 2.5rem;
            }
            .hr-zone-max-value {
                font-size: 2rem;
            }
            .hr-zone-info {
                gap: 1rem;
            }
            .hr-zone-info-value {
                font-size: 1.1rem;
            }
        }

        /* Pace Zone Slide */
        .pace-zone-slide {
            background: linear-gradient(135deg, #0f1a25 0%, #1a1025 100%);
        }

        .pace-zone-container {
            max-width: 800px;
            width: 100%;
        }

        .pace-zone-bars {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .pace-zone-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .pace-zone-label {
            width: 80px;
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            text-align: right;
            flex-shrink: 0;
        }

        .pace-zone-track {
            flex: 1;
            height: 40px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .pace-zone-fill {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            transition: width 1s ease-out;
            min-width: fit-content;
        }

        .pace-zone-fill.easy {
            background: linear-gradient(90deg, #00ff88, #39FF14);
        }

        .pace-zone-fill.aerobic {
            background: linear-gradient(90deg, #00D4FF, #39FF14);
        }

        .pace-zone-fill.tempo {
            background: linear-gradient(90deg, #FFD700, #FF8C00);
        }

        .pace-zone-fill.interval {
            background: linear-gradient(90deg, #FF2D92, #FF6B35);
        }

        .pace-zone-fill.grayzone {
            background: linear-gradient(90deg, #888888, #AAAAAA);
        }

        .pace-zone-fill.threshold {
            background: linear-gradient(90deg, #FF6B35, #FF2D92);
        }

        .pace-zone-fill.sprint {
            background: linear-gradient(90deg, #FF0000, #CC0000);
        }

        .pace-zone-stats {
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: #000;
            font-weight: 700;
            white-space: nowrap;
        }

        .pace-zone-info {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
        }

        .pace-zone-info-item {
            text-align: center;
        }

        .pace-zone-info-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            color: var(--neon-green);
        }

        .pace-zone-info-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            margin-top: 0.25rem;
        }

        @media (max-width: 768px) {
            .pace-zone-label {
                width: 60px;
                font-size: 0.75rem;
            }
            .pace-zone-track {
                height: 35px;
            }
            .pace-zone-stats {
                font-size: 0.7rem;
            }
            .pace-zone-info {
                gap: 1rem;
            }
            .pace-zone-info-value {
                font-size: 1.2rem;
            }
        }

        /* Weather Slide */
        .weather-slide {
            background: linear-gradient(135deg, #0a1525 0%, #1a1030 100%);
        }

        .weather-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            max-width: 1000px;
            width: 100%;
        }

        .weather-category {
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
        }

        .weather-category-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .weather-category-icon {
            font-size: 1.5rem;
        }

        .weather-items {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .weather-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            transition: transform 0.3s;
        }

        .weather-item:hover {
            transform: translateX(5px);
        }

        .weather-item:nth-child(1) {
            border-left: 3px solid var(--neon-green);
        }
        .weather-item:nth-child(2) {
            border-left: 3px solid var(--electric-blue);
        }
        .weather-item:nth-child(3) {
            border-left: 3px solid var(--hot-pink);
        }

        .weather-emoji {
            font-size: 1.8rem;
            flex-shrink: 0;
        }

        .weather-info {
            flex: 1;
            text-align: left;
        }

        .weather-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.2rem;
            color: white;
        }

        .weather-count {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            margin-left: 0.5rem;
        }

        .weather-category.temp .weather-item:nth-child(1) { border-left-color: #FF6B35; }
        .weather-category.temp .weather-item:nth-child(2) { border-left-color: #FFD700; }
        .weather-category.temp .weather-item:nth-child(3) { border-left-color: #00ff88; }

        .weather-category.humidity .weather-item:nth-child(1) { border-left-color: #00D4FF; }
        .weather-category.humidity .weather-item:nth-child(2) { border-left-color: #6B8DD6; }
        .weather-category.humidity .weather-item:nth-child(3) { border-left-color: #9B59B6; }

        @media (max-width: 768px) {
            .weather-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .weather-category {
                display: flex;
                align-items: center;
                padding: 1rem;
                border-radius: 12px;
                gap: 1rem;
            }
            .weather-category-title {
                font-size: 0.75rem;
                margin-bottom: 0;
                flex-direction: column;
                gap: 0.25rem;
                min-width: 80px;
            }
            .weather-category-icon {
                font-size: 1.5rem;
            }
            .weather-items {
                flex: 1;
                flex-direction: row;
            }
            .weather-item {
                padding: 0.75rem;
                border-radius: 10px;
                flex: 1;
            }
            .weather-item:nth-child(2),
            .weather-item:nth-child(3) {
                display: none;
            }
            .weather-emoji {
                font-size: 1.5rem;
            }
            .weather-value {
                font-size: 1rem;
            }
            .weather-count {
                font-size: 0.7rem;
            }
        }

        /* Heatmap Slide */
        .heatmap-slide {
            background: linear-gradient(135deg, #0a0f15 0%, #0f1a20 100%);
        }

        .heatmap-subtitle {
            color: rgba(255,255,255,0.5);
            font-size: 1rem;
            margin-top: -1.5rem;
            margin-bottom: 1.5rem;
        }

        .heatmap-container {
            width: 100%;
            max-width: 800px;
            aspect-ratio: 4/3;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            border: 1px solid rgba(57, 255, 20, 0.2);
            overflow: hidden;
            position: relative;
        }

        #heatmapMap {
            width: 100%;
            height: 100%;
            border-radius: 20px;
        }

        .heatmap-stats {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .heatmap-stat {
            text-align: center;
        }

        .heatmap-stat-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2rem;
            color: var(--neon-green);
            display: block;
        }

        .heatmap-stat-label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        @media (max-width: 768px) {
            .heatmap-container {
                max-width: 100%;
                aspect-ratio: 1/1;
            }
            .heatmap-stats {
                gap: 1rem;
            }
            .heatmap-stat-value {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .how-it-works-btn {
                bottom: 1rem;
                left: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.7rem;
            }
            .arch-modal-content {
                padding: 1.5rem;
                margin: 1rem 0;
            }
            .arch-diagram pre {
                font-size: 0.55rem;
            }
        }

        /* Activity Grid Slide (GitHub-style) */
        .activity-grid-slide {
            background: linear-gradient(135deg, #0a0f15 0%, #0f0a1a 100%);
            --cell-size: 11px;
            --cell-gap: 2px;
            --day-width: 26px;
            --wrapper-gap: 4px;
        }

        .activity-subtitle {
            color: rgba(255,255,255,0.5);
            font-size: 1rem;
            margin-top: -1.5rem;
            margin-bottom: 2rem;
        }

        .activity-grid-container {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 1.5rem;
            width: fit-content;
            max-width: 95vw;
            overflow-x: auto;
        }

        .activity-months {
            margin-bottom: 4px;
            margin-left: calc(var(--day-width) + var(--wrapper-gap));
            font-size: 0.7rem;
            color: rgba(255,255,255,0.5);
            position: relative;
            height: 15px;
            overflow: hidden;
        }

        .activity-months span {
            position: absolute;
            white-space: nowrap;
        }

        .activity-grid-wrapper {
            display: flex;
            gap: var(--wrapper-gap);
        }

        .activity-days {
            display: flex;
            flex-direction: column;
            font-size: 0.65rem;
            color: rgba(255,255,255,0.5);
            width: var(--day-width);
            flex-shrink: 0;
        }

        .activity-days span {
            height: var(--cell-size);
            line-height: var(--cell-size);
            margin-bottom: var(--cell-gap);
        }

        .activity-days span:nth-child(1) { margin-top: calc(var(--cell-size) + var(--cell-gap)); } /* Mon - row 2 */
        .activity-days span:nth-child(2) { margin-top: calc(var(--cell-size) + var(--cell-gap)); } /* Wed - row 4 */
        .activity-days span:nth-child(3) { margin-top: calc(var(--cell-size) + var(--cell-gap)); } /* Fri - row 6 */

        .activity-grid {
            display: grid;
            grid-template-rows: repeat(7, var(--cell-size));
            grid-auto-flow: column;
            grid-auto-columns: var(--cell-size);
            gap: var(--cell-gap);
        }

        .activity-cell {
            width: var(--cell-size);
            height: var(--cell-size);
            border-radius: 2px;
            background: rgba(255,255,255,0.05);
            transition: transform 0.2s, background 0.2s;
            cursor: pointer;
            position: relative;
        }

        .activity-cell:hover {
            transform: scale(1.5);
            z-index: 10;
        }

        .activity-cell[data-level="0"] { background: rgba(255,255,255,0.08); }
        .activity-cell[data-level="1"] { background: rgba(57, 255, 20, 0.3); }
        .activity-cell[data-level="2"] { background: rgba(57, 255, 20, 0.5); }
        .activity-cell[data-level="3"] { background: rgba(57, 255, 20, 0.75); }
        .activity-cell[data-level="4"] { background: #39FF14; }

        .activity-cell::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: calc(100% + 5px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-dark);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 100;
        }

        .activity-cell:hover::after {
            opacity: 1;
        }

        .activity-legend {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.3rem;
            margin-top: 1rem;
            font-size: 0.7rem;
            color: rgba(255,255,255,0.5);
        }

        .legend-box {
            width: 11px;
            height: 11px;
            border-radius: 2px;
        }

        .legend-box[data-level="0"] { background: rgba(255,255,255,0.08); }
        .legend-box[data-level="1"] { background: rgba(57, 255, 20, 0.3); }
        .legend-box[data-level="2"] { background: rgba(57, 255, 20, 0.5); }
        .legend-box[data-level="3"] { background: rgba(57, 255, 20, 0.75); }
        .legend-box[data-level="4"] { background: #39FF14; }

        .legend-label {
            margin: 0 0.3rem;
        }

        .activity-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .activity-stat {
            text-align: center;
        }

        .activity-stat-value {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2rem;
            color: var(--neon-green);
            display: block;
        }

        .activity-stat-label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        @media (max-width: 768px) {
            .activity-grid-slide {
                --cell-size: 9px;
                --cell-gap: 2px;
                --day-width: 18px;
                --wrapper-gap: 4px;
            }
            .activity-grid-container {
                padding: 1rem;
            }
            .activity-days {
                font-size: 0.55rem;
            }
            .activity-months {
                font-size: 0.55rem;
            }
            .activity-stats {
                gap: 1rem;
            }
            .activity-stat-value {
                font-size: 1.5rem;
            }
            .legend-box {
                width: 9px;
                height: 9px;
            }
        }
    </style>
</head>
<body data-new-gr-c-s-check-loaded="14.1267.0" data-gr-ext-installed="" style="" class="">
    <div class="confetti-container" id="confettiContainer"></div>
    <nav class="nav-dots">
        <button class="nav-dot" data-slide="0"></button> <!-- Intro -->
        <button class="nav-dot" data-slide="1"></button> <!-- Total Distance -->
        <button class="nav-dot" data-slide="2"></button> <!-- Time Invested -->
        <button class="nav-dot active" data-slide="3"></button> <!-- Core Stats Grid -->
        <button class="nav-dot" data-slide="4"></button> <!-- PR Board -->
        <button class="nav-dot" data-slide="5"></button> <!-- Heart Stats -->
        <button class="nav-dot" data-slide="6"></button> <!-- Pace Zones -->
        <button class="nav-dot" data-slide="7"></button> <!-- HR Zones -->
        <button class="nav-dot" data-slide="8"></button> <!-- Monthly Breakdown -->
        <button class="nav-dot" data-slide="9"></button> <!-- Run Start Times -->

    </nav>

    <!-- Slide 1: Intro -->
    <section class="slide intro">
        <div class="intro-content">
            <div class="year-selector">
                <select id="yearSelect"><option value="2025">2025</option></select>
            </div>
            <p class="year-badge">Olivia's YEAR IN MOTION</p>
            <h1 class="main-title">
                <span class="running">RUNNING</span>
                <span class="wrapped">WRAPPED</span>
            </h1>
            <p class="intro-subtitle">Olivia's 2025 Journey  132 Runs</p>
        </div>
        <div class="scroll-indicator">
            <span></span>
        </div>
    </section>

    <!-- Slide 2: Total Distance -->
    <section class="slide big-number-slide">
        <div class="big-stat">
            <p class="stat-label">Olivia Covered</p>
            <p class="stat-number" data-animated="true" style="opacity: 1;">924.6</p>
            <p class="stat-unit">kilometres</p>
            <p class="stat-context">C'est l'quivalent d'un Montpellier -> Bruxelles! </p>
        </div>
    </section>

    <!-- Slide 3: Time Invested -->
    <section class="slide big-number-slide" style="background: linear-gradient(180deg, #0a1520 0%, #150a15 100%);">
        <div class="big-stat">
            <p class="stat-label">Time on Olivia's Feet</p>
            <p class="stat-number" data-animated="true" style="opacity: 1;">73.47</p>
            <p class="stat-unit">hours running</p>
            <p class="stat-context">C'est 3 jours complets de pure course! Soit 4 427 minutes </p>
        </div>
    </section>

    <!-- Slide 4: Core Stats Grid -->
    <section class="slide grid-slide">
        <h2 class="slide-title">Olivia's Running Stats</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">90</div>
                <div class="card-label">Total Runs</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">7.40</div>
                <div class="card-label">Avg km/Run</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">27.55</div>
                <div class="card-label">Longest run</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">2.06</div>
                <div class="card-label">Shortest run</div>
            </div>

            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">6:38</div>
                <div class="card-label">Avg Pace /km</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">1.155M</div>
                <div class="card-label">Total Steps</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">15 820</div>
                <div class="card-label">Metres Climbed</div>
            </div>
            <div class="stat-card">
                <div class="card-icon"></div>
                <div class="card-value">56K</div>
                <div class="card-label">Calories Burned</div>
            </div>
        </div>
    </section>

    <!-- Slide 5: PR Board -->
    <section class="slide pr-board-slide">
        <h2 class="slide-title">Olivia's Personal Bests</h2>
        <p style="margin-top: -1.5rem; margin-bottom: 2rem; color: rgba(255,255,255,0.5); font-size: 0.9rem;">PBs across all distances</p>
        <div class="pr-board-container">
            <div class="pr-board-grid" id="prBoardGrid">
                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">400M</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">01:37</div>
                            <div class="pr-details">
                                <span class="pr-pace">4:02/km</span>
                                <span class="pr-date">April 20, 2025</span>
                            </div>
                        </div>
                    
                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">1KM</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">04:57</div>
                            <div class="pr-details">
                                <span class="pr-pace">4:57/km</span>
                                <span class="pr-date">June 15, 2025</span>
                            </div>
                        </div>
                    
                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">5KM</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">28:29</div>
                            <div class="pr-details">
                                <span class="pr-pace">5:42/km</span>
                                <span class="pr-date">February 5, 2025</span>
                            </div>
                        </div>
                    
                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">10KM</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">61:59</div>
                            <div class="pr-details">
                                <span class="pr-pace">6:12/km</span>
                                <span class="pr-date">May 3, 2025</span>
                            </div>
                        </div>

                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">21.1KM</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">154:14</div>
                            <div class="pr-details">
                                <span class="pr-pace">7:21/km</span>
                                <span class="pr-date">April 13, 2025</span>
                            </div>
                        </div>

                    
                        <div class="pr-card no-data">
                            <div class="pr-card-header">
                                <span class="pr-distance">42.2KM</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">--:--</div>
                            <p class="pr-goal">Marathon goal for next year?</p>
                        </div>
                    </div>
        </div>
    </section>


    <!-- Slide 9: Monthly Breakdown -->
    <section class="slide monthly-slide">
        <div class="month-chart-container">
            <h2 class="slide-title">Km By Month</h2>
            <div class="month-bars">
                    <div class="month-bar">
                        <div class="bar" style="height: 109.4px;"><span class="bar-value">109.4km</span></div>
                        <span class="month-label">Jan</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 109.9px;"><span class="bar-value">109.9km</span></div>
                        <span class="month-label">Feb</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 106.6px;"><span class="bar-value">106.6km</span></div>
                        <span class="month-label">Mar</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 65.2px;"><span class="bar-value">65.2km</span></div>
                        <span class="month-label">Apr</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 119.93px;"><span class="bar-value">119.9km</span></div>
                        <span class="month-label">May</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 98.57px;"><span class="bar-value">98.5km</span></div>
                        <span class="month-label">Jun</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 129.25px;"><span class="bar-value">129.2km</span></div>
                        <span class="month-label">Jul</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 10.58px;"><span class="bar-value">10.5km</span></div>
                        <span class="month-label">Aug</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 24.36px;"><span class="bar-value">24.3km</span></div>
                        <span class="month-label">Sep</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 42.81px;"><span class="bar-value">42.8km</span></div>
                        <span class="month-label">Oct</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 71.94px;"><span class="bar-value">71.9km</span></div>
                        <span class="month-label">Nov</span>
                    </div>
                
                    <div class="month-bar">
                        <div class="bar" style="height: 33.55px;"><span class="bar-value">33.5km</span></div>
                        <span class="month-label">Dec*</span>
                    </div>
                </div>
            <p style="margin-top: 1rem; color: rgba(255,255,255,0.5); font-size: 0.9rem; text-align: center;">*Dec ongoing  Jul was Olivia's BIGGEST month (so far)! </p>
        </div>
    </section>

    <!-- Slide 10: Run Start Times -->
    <section class="slide hour-slide">
        <h2 class="slide-title">When Olivia Runs </h2>
        <div class="hour-chart-container">
            <div class="hour-bars">
                <!-- 6am -> 1 -->
                <div class="hour-bar early">
                    <div class="bar" style="height: 18.6666666667px;">
                        <span class="bar-value">1</span>
                    </div>
                    <span class="month-label">6am</span>
                </div>

                <!-- 7am -> 0 -->
                <div class="hour-bar early">
                    <div class="bar" style="height: 0px;">
                        <span class="bar-value">0</span>
                    </div>
                    <span class="month-label">7am</span>
                </div>

                <!-- 8am -> 0 -->
                <div class="hour-bar early">
                    <div class="bar" style="height: 0px;">
                        <span class="bar-value">0</span>
                    </div>
                    <span class="month-label">8am</span>
                </div>

                <!-- 9am -> 0 -->
                <div class="hour-bar morning">
                    <div class="bar" style="height: 0px;">
                        <span class="bar-value">0</span>
                    </div>
                    <span class="month-label">9am</span>
                </div>

                <!-- 10am -> 2 -->
                <div class="hour-bar morning">
                    <div class="bar" style="height: 37.3333333333px;">
                        <span class="bar-value">2</span>
                    </div>
                    <span class="month-label">10am</span>
                </div>

                <!-- 11am -> 2 -->
                <div class="hour-bar morning">
                    <div class="bar" style="height: 37.3333333333px;">
                        <span class="bar-value">2</span>
                    </div>
                    <span class="month-label">11am</span>
                </div>

                <!-- 12pm -> 0 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 0px;">
                        <span class="bar-value">0</span>
                    </div>
                    <span class="month-label">12pm</span>
                </div>

                <!-- 1pm -> 0 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 0px;">
                        <span class="bar-value">0</span>
                    </div>
                    <span class="month-label">1pm</span>
                </div>

                <!-- 2pm -> 2 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 37.3333333333px;">
                        <span class="bar-value">2</span>
                    </div>
                    <span class="month-label">2pm</span>
                </div>

                <!-- 3pm -> 10 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 186.6666666667px;">
                        <span class="bar-value">10</span>
                    </div>
                    <span class="month-label">3pm</span>
                </div>

                <!-- 4pm -> 6 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 112px;">
                        <span class="bar-value">6</span>
                    </div>
                    <span class="month-label">4pm</span>
                </div>

                <!-- 5pm -> 12 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 224px;">
                        <span class="bar-value">12</span>
                    </div>
                    <span class="month-label">5pm</span>
                </div>

                <!-- 6pm -> 15 (max) -->
                <div class="hour-bar">
                    <div class="bar" style="height: 280px;">
                        <span class="bar-value">15</span>
                    </div>
                    <span class="month-label">6pm</span>
                </div>

                <!-- 7pm -> 8 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 149.3333333333px;">
                        <span class="bar-value">8</span>
                    </div>
                    <span class="month-label">7pm</span>
                </div>

                <!-- 8pm -> 13 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 242.6666666667px;">
                        <span class="bar-value">13</span>
                    </div>
                    <span class="month-label">8pm</span>
                </div>

                <!-- 9pm -> 6 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 112px;">
                        <span class="bar-value">6</span>
                    </div>
                    <span class="month-label">9pm</span>
                </div>

                <!-- 10pm -> 3 -->
                <div class="hour-bar">
                    <div class="bar" style="height: 56px;">
                        <span class="bar-value">3</span>
                    </div>
                    <span class="month-label">10pm</span>
                </div>
                </div>
            <p style="margin-top: 1rem; color: rgba(255,255,255,0.5); font-size: 0.9rem; text-align: center;">Olivia's a night owl! <strong style="color: var(--neon-green);">56%</strong> of runs started after 6pm</p>
        </div>
    </section>

 

    <!-- Slide 12: Running Heatmap -->
    <section class="slide heatmap-slide">
        <h2 class="slide-title">Olivia's Running Routes </h2>
        <div style="width: 100%; height: 500px; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
            <iframe 
                src="running_walking_heatmap.html" 
                style="width: 100%; height: 100%; border: none; border-radius: 12px;"
                frameborder="0"
                allowfullscreen>
            </iframe>
        </div>
        <p class="slide-subtitle" style="text-align: center; margin-top: 16px; color: #666; font-size: 0.9em;">
            Courses + Marches (plus rouge = plus emprunt)
        </p>
    </section>

    <!-- Slide 13: Activity Grid (GitHub-style) -->
    <section class="slide activity-grid-slide">
        <h2 class="slide-title">Olivia's Running Calendar </h2>
        <p class="activity-subtitle">Every run, every day</p>
        <div class="activity-grid-container">
            <div class="activity-months" id="activityMonths" style="width: 663px;">
                <span style="left: 0px;">Jan</span><span style="left: 52px;">Feb</span>
                <span style="left: 104px;">Mar</span><span style="left: 169px;">Apr</span>
                <span style="left: 221px;">May</span><span style="left: 286px;">Jun</span>
                <span style="left: 338px;">Jul</span><span style="left: 390px;">Aug</span>
                <span style="left: 455px;">Sep</span><span style="left: 507px;">Oct</span>
                <span style="left: 559px;">Nov</span><span style="left: 624px;">Dec</span>
            </div>
            <div class="activity-grid-wrapper">
                <div class="activity-days">
                    <span>Mon</span><span>Wed</span><span>Fri</span>
                </div>
                <div class="activity-grid" id="activityGrid">
                    
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-01: No runs"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-01-02: 2 run(s), 14.9km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-03: 1 run(s), 6.6km"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-01-04: 1 run(s), 11.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-05: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-07: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-08: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-09: 1 run(s), 5.9km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-10: No runs"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-01-11: 1 run(s), 12.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-12: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-13: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-15: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-01-16: 2 run(s), 8.5km"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-01-17: 1 run(s), 11.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-18: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-19: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-20: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-21: 1 run(s), 5.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-23: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-01-24: 1 run(s), 8.8km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-26: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-27: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-28: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-01-29: 1 run(s), 7.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-01-31: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-01: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-02: 1 run(s), 9.7km"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-02-03: 1 run(s), 4.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-04: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-02-05: 1 run(s), 7.9km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-07: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-08: 1 run(s), 11.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-09: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-02-10: 1 run(s), 4.8km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-11: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-02-12: 1 run(s), 5.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-13: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-14: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-15: 1 run(s), 8.6km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-02-16: 1 run(s), 6.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-18: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-19: 1 run(s), 10.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-20: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-02-21: 1 run(s), 5.7km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-22: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-23: 1 run(s), 9.3km"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-02-24: 1 run(s), 16.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-26: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-02-27: 1 run(s), 10.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-02-28: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-03-01: 1 run(s), 11.6km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-03: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-03-04: 1 run(s), 4.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-05: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-07: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-08: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-03-09: 1 run(s), 8.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-10: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-11: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-03-12: 1 run(s), 6.8km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-13: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-14: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-03-15: 1 run(s), 7.1km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-03-16: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-17: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-03-18: 1 run(s), 3.8km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-21: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-03-22: 1 run(s), 7.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-24: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-03-25: 1 run(s), 10.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-28: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-03-29: 1 run(s), 8.8km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-03-30: 1 run(s), 5.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-03-31: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-04-01: 1 run(s), 3.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-03: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-04: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-05: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-04-06: 1 run(s), 7.9km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-04-07: 1 run(s), 6.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-08: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-09: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-04-10: 1 run(s), 3.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-11: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-04-12: 1 run(s), 4.4km"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-04-13: 1 run(s), 21.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-15: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-19: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-04-20: 1 run(s), 5.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-23: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-04-24: 1 run(s), 8.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-26: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-04-27: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-04-30: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-05-01: 1 run(s), 5.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-02: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-05-03: 1 run(s), 10.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-04: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-05: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-05-06: 1 run(s), 6.6km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-07: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-05-08: 1 run(s), 5.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-09: No runs"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-05-10: 1 run(s), 13.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-11: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-12: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-05-13: 1 run(s), 6.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-15: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-16: No runs"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-05-17: 1 run(s), 18.9km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-19: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-05-20: 1 run(s), 11.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-21: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-05-22: 1 run(s), 6.6km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-05-31: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-03: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-06-04: 1 run(s), 5.1km"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-06-05: 1 run(s), 10.7km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-06: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-06-07: 1 run(s), 5.7km"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-06-08: 1 run(s), 19.7km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-06-09: 1 run(s), 6.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-10: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-11: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-06-12: 1 run(s), 6.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-13: No runs"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-06-14: 1 run(s), 13.0km"></div>
            <div class="activity-cell" data-level="4" data-tooltip="2025-06-15: 1 run(s), 12.9km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-06-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-03: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-04: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-05: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-07: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-08: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-09: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-10: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-07-11: 1 run(s), 5.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-12: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-07-13: 1 run(s), 4.5km"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-07-14: 1 run(s), 2.3km"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-07-15: 1 run(s), 4.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-18: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-07-19: 1 run(s), 5.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-07-31: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-03: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-04: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-05: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-07: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-08: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-08-09: 1 run(s), 4.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-10: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-11: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-12: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-13: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-15: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-08-31: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-03: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-04: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-05: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-07: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-08: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-09: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-10: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-11: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-12: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-13: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-15: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-19: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-09-20: 1 run(s), 6.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-22: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-09-23: 1 run(s), 8.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-26: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-09-27: 1 run(s), 5.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-28: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-09-29: 1 run(s), 4.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-09-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-02: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-10-03: 1 run(s), 3.1km"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-10-04: 1 run(s), 5.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-05: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-10-06: 1 run(s), 5.7km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-07: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-08: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-09: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-10: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-10-11: 1 run(s), 4.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-12: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-10-13: 1 run(s), 4.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-15: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-17: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-10-18: 1 run(s), 5.7km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-20: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-10-21: 1 run(s), 5.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-25: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-10-26: 1 run(s), 4.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-28: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-10-29: 1 run(s), 4.6km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-10-31: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-01: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-11-02: 1 run(s), 4.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-03: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-04: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-11-05: 1 run(s), 6.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-06: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-07: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-11-08: 1 run(s), 6.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-09: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-11-10: 1 run(s), 3.5km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-11: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-12: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-11-13: 1 run(s), 7.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-14: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-15: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-11-16: 1 run(s), 4.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-17: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-11-18: 1 run(s), 4.1km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-21: No runs"></div>
            <div class="activity-cell" data-level="3" data-tooltip="2025-11-22: 1 run(s), 8.3km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-25: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-11-26: 1 run(s), 7.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-28: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-11-29: 1 run(s), 7.7km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-11-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-01: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-02: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-03: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-12-04: 1 run(s), 4.9km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-05: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-12-06: 1 run(s), 5.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-07: No runs"></div>
            <div class="activity-cell" data-level="1" data-tooltip="2025-12-08: 1 run(s), 3.4km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-09: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-12-10: 1 run(s), 6.8km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-11: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-12: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-12-13: 1 run(s), 6.0km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-14: No runs"></div>
            <div class="activity-cell" data-level="2" data-tooltip="2025-12-15: 1 run(s), 7.2km"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-16: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-17: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-18: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-19: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-20: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-21: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-22: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-23: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-24: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-25: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-26: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-27: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-28: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-29: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-30: No runs"></div>
            <div class="activity-cell" data-level="0" data-tooltip="2025-12-31: No runs"></div>
                </div>
            </div>
            <div class="activity-legend">
                <span class="legend-label">Less</span>
                <span class="legend-box" data-level="0"></span>
                <span class="legend-box" data-level="1"></span>
                <span class="legend-box" data-level="2"></span>
                <span class="legend-box" data-level="3"></span>
                <span class="legend-box" data-level="4"></span>
                <span class="legend-label">More</span>
            </div>
        </div>
        <div class="activity-stats">
            <div class="activity-stat">
                <span class="activity-stat-value" id="mostActiveDay">Friday</span>
                <span class="activity-stat-label">Favourite Day</span>
            </div>
            <div class="activity-stat">
                <span class="activity-stat-value" id="weekendRuns">43</span>
                <span class="activity-stat-label">Weekend Runs</span>
            </div>
            <div class="activity-stat">
                <span class="activity-stat-value" id="weekdayRuns">55</span>
                <span class="activity-stat-label">Weekday Runs</span>
            </div>
        </div>
    </section>


    <!-- Slide 15: Fun Equivalents -->
    <section class="slide equivalents-slide">
        <h2 class="slide-title">What Olivia's Running Equals </h2>
        <div class="equiv-grid">
            <div class="equiv-card">
                <div class="equiv-emoji"></div>
                <div class="equiv-value">2.3M</div>
                <div class="equiv-label">Bunny hops</div>
                <div class="equiv-context">boing boing..</div>
            </div>
            <div class="equiv-card">
                <div class="equiv-emoji"></div>
                <div class="equiv-value">2.3%</div>
                <div class="equiv-label">Around Earth</div>
                <div class="equiv-context">Of the circumference</div>
            </div>
            <div class="equiv-card">
                <div class="equiv-emoji"></div>
                <div class="equiv-value">1.78x</div>
                <div class="equiv-label">Mount Everest Climbed</div>
                <div class="equiv-context">In elevation gain#Kaizen</div>
            </div>
        </div>
    </section>




    <script>
        // Initialize Mermaid with dark theme
        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#39FF14',
                primaryTextColor: '#fff',
                primaryBorderColor: '#39FF14',
                lineColor: '#00D4FF',
                secondaryColor: '#12121a',
                tertiaryColor: '#1a1a2e',
                background: 'transparent',
                mainBkg: '#12121a',
                nodeBorder: '#39FF14',
                clusterBkg: 'rgba(255,255,255,0.05)',
                clusterBorder: 'rgba(255,255,255,0.2)',
                titleColor: '#fff',
                edgeLabelBackground: '#12121a'
            },
            flowchart: {
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // ============================================
        // DATA SOURCE TOGGLE
        // Set to 'blob' for static JSON or 'api' for live API
        // ============================================
        const DATA_SOURCE = 'blob'; // 'blob' or 'api'
        const BLOB_URL = 'https://aldishoppingliststorage.blob.core.windows.net/running/wrapped/runningWrapped_{year}.json';
        const API_URL = 'https://py-garmin-api.azurewebsites.net/api/running-wrapped?year={year}';

        // Year selector setup
        const yearSelect = document.getElementById('yearSelect');
        const currentYear = new Date().getFullYear();
        const startYear = 2025;

        // Populate year dropdown
        for (let year = currentYear; year >= startYear; year--) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            if (year === currentYear) option.selected = true;
            yearSelect.appendChild(option);
        }

        // Handle year change
        yearSelect.addEventListener('change', () => {
            loadRunningData(yearSelect.value);
        });

        // Fetch and populate data from configured source
        async function loadRunningData(year = currentYear) {
            try {
                let url;
                if (DATA_SOURCE === 'api') {
                    url = API_URL.replace('{year}', year);
                } else {
                    url = BLOB_URL.replace('{year}', year) + `?t=${Date.now()}`;
                }

                const response = await fetch(url);
                const dataArray = await response.json();
                const data = Array.isArray(dataArray) ? dataArray[0] : dataArray;
                populateData(data, year);
            } catch (error) {
                console.error('Failed to load running data:', error);
            }
        }

        function formatNumber(num, decimals = 0) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return Math.round(num / 1000) + 'K';
            return decimals > 0 ? num.toFixed(decimals) : Math.round(num);
        }

        function formatPace(paceStr) {
            // Convert "06:33" to "6:33"
            if (!paceStr) return '--:--';
            const parts = paceStr.split(':');
            return parseInt(parts[0]) + ':' + parts[1];
        }

        function formatTime(timeStr) {
            // Convert "00:45:48" to "45:48" or "01:15:58" to "1:15:58"
            if (!timeStr) return '--:--';
            const parts = timeStr.split(':');
            if (parts[0] === '00') {
                return parts[1] + ':' + parts[2];
            }
            return parseInt(parts[0]) + ':' + parts[1] + ':' + parts[2];
        }

        function formatMonth(monthStr) {
            // Convert "2025-02" to "February"
            if (!monthStr) return '';
            const months = ['January', 'February', 'March', 'April', 'May', 'June',
                           'July', 'August', 'September', 'October', 'November', 'December'];
            const monthNum = parseInt(monthStr.split('-')[1]) - 1;
            return months[monthNum];
        }

        function calculateImprovement(slowTime, fastTime) {
            if (!slowTime || !fastTime) return '??:??';
            const slowParts = slowTime.split(':').map(Number);
            const fastParts = fastTime.split(':').map(Number);

            let slowSeconds = slowParts[0] * 3600 + slowParts[1] * 60 + slowParts[2];
            let fastSeconds = fastParts[0] * 3600 + fastParts[1] * 60 + fastParts[2];

            let diffSeconds = slowSeconds - fastSeconds;
            let mins = Math.floor(diffSeconds / 60);
            let secs = diffSeconds % 60;

            return mins + ':' + String(secs).padStart(2, '0');
        }

        function populateData(data, year) {
            // Slide 2: Total Distance
            document.querySelector('.big-number-slide .stat-number').textContent = data.TotalKm.toFixed(1);
            const townsvilleToMtIsa = 900; // km one way
            const driveMultiple = (data.TotalKm / townsvilleToMtIsa).toFixed(1);
            document.querySelector('.big-number-slide .stat-context').innerHTML = `That's ${driveMultiple}x the drive from Townsville to Mount Isa! `;

            // Slide 3: Time Invested
            const timeSlide = document.querySelectorAll('.big-number-slide')[1];
            timeSlide.querySelector('.stat-number').textContent = data.TotalHours.toFixed(1);
            const totalMinutes = Math.round(data.TotalHours * 60);
            timeSlide.querySelector('.stat-context').innerHTML = `Over ${Math.floor(data.TotalHours / 24)} full days of pure running! That's ${totalMinutes.toLocaleString()} minutes of dedication `;

            // Slide 4: Core Stats Grid
            const cardValues = document.querySelectorAll('.stat-card .card-value');
            cardValues[0].textContent = data.TotalRuns;
            cardValues[1].textContent = data.AverageKm.toFixed(2);
            cardValues[2].textContent = data.LongestRun.toFixed(1);
            cardValues[3].textContent = data.ShortestRun.toFixed(2);
            cardValues[4].textContent = formatPace(data.AveragePace);
            cardValues[5].textContent = formatNumber(data.TotalSteps);
            cardValues[6].textContent = Math.round(data.TotalElevationGain);
            cardValues[7].textContent = formatNumber(data.TotalCaloriesBurned);

            // Slide 5: PR Board
            populatePRBoard(data);

            // Slide 6: Heart Stats
            const heartStatValues = document.querySelectorAll('.heart-stat-value');
            heartStatValues[0].textContent = formatNumber(data.TotalHeartBeats);
            heartStatValues[1].textContent = Math.round(data.AverageBPM); // Using PeakBPM as avg since AverageBPM seems wrong
            heartStatValues[2].textContent = Math.round(data.PeakBPM);
            heartStatValues[3].textContent = Math.round(data.MinBPM);

            const heartNote = document.querySelector('.heart-slide p[style]');
            heartNote.innerHTML = `John's heart beat nearly <strong style="color: var(--hot-pink);">${Math.round(data.TotalHeartBeats / 1000000 * 10) / 10} million times</strong> just during his runs!`;

            // Slide 7: Pace Zones
            populatePaceZones(data);

            // Slide 8: HR Zones
            populateHRZones(data);

            // Slide 9: Monthly Breakdown
            populateMonthlyChart(data);

            // Slide 10: Hourly Runs
            populateHourlyChart(data);

            // Slide 11: Weather
            populateWeatherSection(data);

            // Slide 12: Heatmap
            if (data.HeatmapPolylines) {
                populateHeatmap(data.HeatmapPolylines);
            }

            // Slide 13: Activity Grid
            populateActivityGrid(data, year);

            // Slide 14: Shoes
            populateShoes(data);

            // Slide 15: Fun Equivalents
            const equivValues = document.querySelectorAll('.equiv-value');
            equivValues[0].textContent = data.BigMacBurned;
            equivValues[1].textContent = data.XXXXGoldsBurned;
            equivValues[2].textContent = data.PctAroundEarth.toFixed(1) + '%';
            equivValues[3].textContent = (data.PctOfMtEverestClimbed / 100).toFixed(2) + 'x';
            equivValues[4].textContent = data.LightBulbHours;
            equivValues[5].textContent = data.KangarooHops.toLocaleString();

            // Slide 16: Airtime
            populateAirtime(data);

            // Slide 17: Can John Outrun?
            populateOutrun(data);

            // Slide 18: Sweat Equity
            populateSweat(data);

            // Slide 19: Power Output
            const powerSlide = document.querySelector('.power-slide');
            powerSlide.querySelector('.stat-number').textContent = Math.round(data.TotalMegaJoules);
            const powerItems = powerSlide.querySelectorAll('.power-item-value');
            powerItems[0].textContent = data.TotalkWhGenerated.toFixed(1);
            powerItems[1].textContent = Math.round(data.AvgRunningPower) + 'W';
            powerItems[2].textContent = data.PhoneCharges.toLocaleString();
            powerItems[3].textContent = data.LitresOfPetrol.toFixed(1);

            // Slide 17: Run Title Awards
            populateAwardsSection(data);

            // Slide 20: Music
            populateMusicSection(data);

            // Slide 21: Running Persona (Finale)
            populatePersona(data);

            // Update intro subtitle
            document.querySelector('.intro-subtitle').textContent = `John's ${year} Journey  ${data.TotalRuns} Runs`;
        }

        function populateMonthlyChart(data) {
            const monthlyData = [
                { label: 'Jan', value: data.JanKm },
                { label: 'Feb', value: data.FebKm },
                { label: 'Mar', value: data.MarKm },
                { label: 'Apr', value: data.AprKm },
                { label: 'May', value: data.MayKm },
                { label: 'Jun', value: data.JunKm },
                { label: 'Jul', value: data.JulKm },
                { label: 'Aug', value: data.AugKm },
                { label: 'Sep', value: data.SepKm },
                { label: 'Oct', value: data.OctKm },
                { label: 'Nov', value: data.NovKm },
                { label: 'Dec', value: data.DecKm }
            ];

            const maxValue = Math.max(...monthlyData.map(m => m.value));
            const maxHeight = 280; // Max bar height in pixels

            const monthBars = document.querySelector('.month-bars');
            monthBars.innerHTML = monthlyData.map((month, index) => {
                const height = maxValue > 0 ? (month.value / maxValue) * maxHeight : 0;
                const isCurrentMonth = new Date().getMonth() === index;
                const label = isCurrentMonth ? month.label + '*' : month.label;
                return `
                    <div class="month-bar">
                        <div class="bar" style="height: ${height}px;"><span class="bar-value">${Math.round(month.value)}km</span></div>
                        <span class="month-label">${label}</span>
                    </div>
                `;
            }).join('');

            // Find biggest month and current month
            const biggestMonth = monthlyData.reduce((max, m) => m.value > max.value ? m : max);
            const currentMonthIndex = new Date().getMonth();
            const currentMonthLabel = monthlyData[currentMonthIndex].label;
            const monthNote = document.querySelector('.month-chart-container > p');
            if (monthNote) {
                monthNote.innerHTML = `*${currentMonthLabel} ongoing  ${biggestMonth.label} was John's BIGGEST month (so far)! `;
            }
        }

        function populateHourlyChart(data) {
            const hourlyData = [
                { label: '4am', value: data.Hour4amRuns, class: 'early' },
                { label: '5am', value: data.Hour5amRuns, class: 'early' },
                { label: '6am', value: data.Hour6amRuns, class: 'early' },
                { label: '7am', value: data.Hour7amRuns, class: 'morning' },
                { label: '8am', value: data.Hour8amRuns, class: 'morning' },
                { label: '9am', value: data.Hour9amRuns, class: 'morning' },
                { label: '10am', value: data.Hour10amRuns, class: '' },
                { label: '11am', value: data.Hour11amRuns, class: '' },
                { label: '12pm', value: data.Hour12pmRuns, class: '' },
                { label: '1pm', value: data.Hour1pmRuns, class: '' },
                { label: '2pm', value: data.Hour2pmRuns, class: '' },
                { label: '3pm', value: data.Hour3pmRuns, class: '' },
                { label: '4pm', value: data.Hour4pmRuns, class: '' },
                { label: '5pm', value: data.Hour5pmRuns, class: '' },
                { label: '6pm', value: data.Hour6pmRuns, class: '' }
            ].filter(h => h.value > 0 || ['5am', '6am', '7am', '4pm', '5pm'].includes(h.label));

            const maxValue = Math.max(...hourlyData.map(h => h.value));
            const maxHeight = 280;

            const hourBars = document.querySelector('.hour-bars');
            hourBars.innerHTML = hourlyData.map(hour => {
                const height = maxValue > 0 ? (hour.value / maxValue) * maxHeight : 0;
                return `
                    <div class="hour-bar ${hour.class}">
                        <div class="bar" style="height: ${height}px;"><span class="bar-value">${hour.value}</span></div>
                        <span class="month-label">${hour.label}</span>
                    </div>
                `;
            }).join('');

            // Calculate early bird percentage
            const earlyRuns = data.Hour4amRuns + data.Hour5amRuns + data.Hour6amRuns;
            const earlyPct = Math.round((earlyRuns / data.TotalRuns) * 100);
            const hourNote = document.querySelector('.hour-chart-container > p');
            if (hourNote) {
                hourNote.innerHTML = `John's an early bird!  <strong style="color: var(--neon-green);">${earlyPct}%</strong> of runs started before 7am`;
            }
        }

        function formatPaceFromSeconds(totalSeconds) {
            if (!totalSeconds) return '--:--';
            const mins = Math.floor(totalSeconds / 60);
            const secs = Math.round(totalSeconds % 60);
            return `${mins}:${String(secs).padStart(2, '0')}`;
        }

        function populatePaceZones(data) {
            // Use Strava's actual pace zone time data (6 zones)
            const zones = [
                { name: 'Active Recovery', seconds: data.PaceZone1Seconds || 0, pct: data.PaceZone1Pct || 0, class: 'easy' },
                { name: 'Endurance', seconds: data.PaceZone2Seconds || 0, pct: data.PaceZone2Pct || 0, class: 'aerobic' },
                { name: 'Tempo', seconds: data.PaceZone3Seconds || 0, pct: data.PaceZone3Pct || 0, class: 'tempo' },
                { name: 'Threshold', seconds: data.PaceZone4Seconds || 0, pct: data.PaceZone4Pct || 0, class: 'threshold' },
                { name: 'VO2max', seconds: data.PaceZone5Seconds || 0, pct: data.PaceZone5Pct || 0, class: 'interval' },
                { name: 'Anaerobic', seconds: data.PaceZone6Seconds || 0, pct: data.PaceZone6Pct || 0, class: 'sprint' }
            ];

            const totalSeconds = zones.reduce((sum, z) => sum + z.seconds, 0);
            const maxSeconds = Math.max(...zones.map(z => z.seconds));

            const paceZoneBars = document.getElementById('paceZoneBars');
            if (paceZoneBars) {
                paceZoneBars.innerHTML = zones.map(zone => {
                    const widthPct = maxSeconds > 0 ? (zone.seconds / maxSeconds) * 100 : 0;
                    const duration = formatDuration(zone.seconds);
                    return `
                        <div class="pace-zone-bar">
                            <span class="pace-zone-label">${zone.name}</span>
                            <div class="pace-zone-track">
                                <div class="pace-zone-fill ${zone.class}" style="width: ${widthPct}%;">
                                    <span class="pace-zone-stats">${duration}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Info section with percentages from Strava
            const paceZoneInfo = document.getElementById('paceZoneInfo');
            if (paceZoneInfo) {
                const z1Pct = Math.round(zones[0].pct);
                const z2Pct = Math.round(zones[1].pct);
                const z3Pct = Math.round(zones[2].pct);
                const z4Pct = Math.round(zones[3].pct);
                const z5Pct = Math.round(zones[4].pct);
                const z6Pct = Math.round(zones[5].pct);

                paceZoneInfo.innerHTML = `
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #39FF14">${z1Pct}%</div>
                        <div class="pace-zone-info-label">Z1 Recovery</div>
                    </div>
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #00D4FF">${z2Pct}%</div>
                        <div class="pace-zone-info-label">Z2 Endurance</div>
                    </div>
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #FFD700">${z3Pct}%</div>
                        <div class="pace-zone-info-label">Z3 Tempo</div>
                    </div>
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #FF8C00">${z4Pct}%</div>
                        <div class="pace-zone-info-label">Z4 Threshold</div>
                    </div>
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #FF2D92">${z5Pct}%</div>
                        <div class="pace-zone-info-label">Z5 VO2max</div>
                    </div>
                    <div class="pace-zone-info-item">
                        <div class="pace-zone-info-value" style="color: #FF0000">${z6Pct}%</div>
                        <div class="pace-zone-info-label">Z6 Anaerobic</div>
                    </div>
                `;
            }
        }

        function formatBeats(beats) {
            if (!beats) return '0';
            if (beats >= 1000000) return (beats / 1000000).toFixed(1) + 'M';
            if (beats >= 1000) return Math.round(beats / 1000) + 'K';
            return Math.round(beats).toLocaleString();
        }

        function formatDuration(seconds) {
            if (!seconds) return '0m';
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            if (hrs > 0) return `${hrs}h ${mins}m`;
            return `${mins}m`;
        }

        function populateHRZones(data) {
            // Use Strava's actual zone time data (Strava HR zones)
            const zones = [
                { name: 'Z1', label: 'Endurance', seconds: data.HRZone1Seconds || 0, pct: data.HRZone1Pct || 0, class: 'z1' },
                { name: 'Z2', label: 'Moderate', seconds: data.HRZone2Seconds || 0, pct: data.HRZone2Pct || 0, class: 'z2' },
                { name: 'Z3', label: 'Tempo', seconds: data.HRZone3Seconds || 0, pct: data.HRZone3Pct || 0, class: 'z3' },
                { name: 'Z4', label: 'Threshold', seconds: data.HRZone4Seconds || 0, pct: data.HRZone4Pct || 0, class: 'z4' },
                { name: 'Z5', label: 'Anaerobic', seconds: data.HRZone5Seconds || 0, pct: data.HRZone5Pct || 0, class: 'z5' }
            ];

            const totalSeconds = zones.reduce((sum, z) => sum + z.seconds, 0);
            const maxSeconds = Math.max(...zones.map(z => z.seconds));

            // Update LTHR display
            const estMaxHR = document.getElementById('estMaxHR');
            if (estMaxHR) {
                estMaxHR.textContent = data.LTHR || '--';
            }

            const hrZoneBars = document.getElementById('hrZoneBars');
            if (hrZoneBars) {
                hrZoneBars.innerHTML = zones.map(zone => {
                    const widthPct = maxSeconds > 0 ? (zone.seconds / maxSeconds) * 100 : 0;
                    const duration = formatDuration(zone.seconds);
                    return `
                        <div class="hr-zone-bar">
                            <span class="hr-zone-label">
                                ${zone.name} ${zone.label}
                            </span>
                            <div class="hr-zone-track">
                                <div class="hr-zone-fill ${zone.class}" style="width: ${widthPct}%;">
                                    <span class="hr-zone-stats">${duration}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Info section with percentages from Strava
            const hrZoneInfo = document.getElementById('hrZoneInfo');
            if (hrZoneInfo) {
                const z1Pct = Math.round(zones[0].pct);
                const z2Pct = Math.round(zones[1].pct);
                const z3Pct = Math.round(zones[2].pct);
                const z4Pct = Math.round(zones[3].pct);
                const z5Pct = Math.round(zones[4].pct);

                hrZoneInfo.innerHTML = `
                    <div class="hr-zone-info-item">
                        <div class="hr-zone-info-value" style="color: #63B3ED">${z1Pct}%</div>
                        <div class="hr-zone-info-label">Z1 Recovery</div>
                    </div>
                    <div class="hr-zone-info-item">
                        <div class="hr-zone-info-value" style="color: #68D391">${z2Pct}%</div>
                        <div class="hr-zone-info-label">Z2 Aerobic</div>
                    </div>
                    <div class="hr-zone-info-item">
                        <div class="hr-zone-info-value" style="color: #F6E05E">${z3Pct}%</div>
                        <div class="hr-zone-info-label">Z3 Tempo</div>
                    </div>
                    <div class="hr-zone-info-item">
                        <div class="hr-zone-info-value" style="color: #F6AD55">${z4Pct}%</div>
                        <div class="hr-zone-info-label">Z4 Threshold</div>
                    </div>
                    <div class="hr-zone-info-item">
                        <div class="hr-zone-info-value" style="color: #FC8181">${z5Pct}%</div>
                        <div class="hr-zone-info-label">Z5 VO2max</div>
                    </div>
                `;
            }
        }

        function populateMusicSection(data) {
            const songs = [
                { name: data.TopSong1, plays: data.TopSong1Plays },
                { name: data.TopSong2, plays: data.TopSong2Plays },
                { name: data.TopSong3, plays: data.TopSong3Plays },
                { name: data.TopSong4, plays: data.TopSong4Plays },
                { name: data.TopSong5, plays: data.TopSong5Plays },
                { name: data.TopSong6, plays: data.TopSong6Plays }
            ].filter(s => s.name);

            const tracksList = document.querySelector('.tracks-list');
            tracksList.innerHTML = songs.map((song, index) => {
                const parts = song.name.split(' - ');
                const artist = parts[0] || 'Unknown';
                const trackName = parts[1] || song.name;

                return `
                    <div class="track-item">
                        <span class="track-rank">${index + 1}</span>
                        <div class="track-info">
                            <p class="track-name">${trackName}</p>
                            <p class="track-artist">${artist}</p>
                        </div>
                        <span class="track-plays">${song.plays} plays</span>
                    </div>
                `;
            }).join('');
        }

        function populateAwardsSection(data) {
            const awards = [
                { emoji: data.Award1Emoji, category: data.Award1Category, title: data.Award1Title, date: data.Award1RunDate, distance: data.Award1Distance, pace: data.Award1Pace, commentary: data.Award1Commentary },
                { emoji: data.Award2Emoji, category: data.Award2Category, title: data.Award2Title, date: data.Award2RunDate, distance: data.Award2Distance, pace: data.Award2Pace, commentary: data.Award2Commentary },
                { emoji: data.Award3Emoji, category: data.Award3Category, title: data.Award3Title, date: data.Award3RunDate, distance: data.Award3Distance, pace: data.Award3Pace, commentary: data.Award3Commentary },
                { emoji: data.Award4Emoji, category: data.Award4Category, title: data.Award4Title, date: data.Award4RunDate, distance: data.Award4Distance, pace: data.Award4Pace, commentary: data.Award4Commentary },
                { emoji: data.Award5Emoji, category: data.Award5Category, title: data.Award5Title, date: data.Award5RunDate, distance: data.Award5Distance, pace: data.Award5Pace, commentary: data.Award5Commentary },
                { emoji: data.Award6Emoji, category: data.Award6Category, title: data.Award6Title, date: data.Award6RunDate, distance: data.Award6Distance, pace: data.Award6Pace, commentary: data.Award6Commentary }
            ].filter(a => a.title);

            const titlesGrid = document.querySelector('.titles-grid');
            titlesGrid.innerHTML = awards.map(award => {
                // Strip ?? where emojis were lost due to database collation (but keep single ?)
                const cleanTitle = (award.title || '').replace(/\?\?/g, '').trim();
                return `
                    <div class="title-card">
                        <div class="title-card-header">
                            <span class="title-emoji">${award.emoji || ''}</span>
                            <span class="title-category">${award.category || ''}</span>
                        </div>
                        <p class="title-name">"${cleanTitle}"</p>
                        <p class="title-details">${award.date} - ${award.distance} @ ${award.pace}. ${award.commentary || ''}</p>
                    </div>
                `;
            }).join('');
        }

        // Weather description to emoji mapping
        const weatherEmojis = {
            "Clear sky": "",
            "Mainly clear": "",
            "Partly cloudy": "",
            "Overcast": "",
            "Fog": "",
            "Depositing rime fog": "",
            "Light drizzle": "",
            "Moderate drizzle": "",
            "Dense drizzle": "",
            "Light freezing drizzle": "",
            "Dense freezing drizzle": "",
            "Slight rain": "",
            "Moderate rain": "",
            "Heavy rain": "",
            "Light freezing rain": "",
            "Heavy freezing rain": "",
            "Slight snow": "",
            "Moderate snow": "",
            "Heavy snow": "",
            "Snow grains": "",
            "Slight rain showers": "",
            "Moderate rain showers": "",
            "Violent rain showers": "",
            "Slight snow showers": "",
            "Heavy snow showers": "",
            "Thunderstorm": "",
            "Thunderstorm with slight hail": "",
            "Thunderstorm with heavy hail": ""
        };

        function getWeatherEmoji(description) {
            if (!description) return "";
            // Try exact match first, then trimmed, then case-insensitive
            const trimmed = description.trim();
            if (weatherEmojis[trimmed]) return weatherEmojis[trimmed];

            // Case-insensitive fallback
            const lower = trimmed.toLowerCase();
            for (const [key, emoji] of Object.entries(weatherEmojis)) {
                if (key.toLowerCase() === lower) return emoji;
            }
            return "";
        }

        function getTempEmoji(temp) {
            if (temp >= 35) return "";
            if (temp >= 30) return "";
            if (temp >= 25) return "";
            if (temp >= 20) return "";
            if (temp >= 15) return "";
            if (temp >= 10) return "";
            return "";
        }

        function getHumidityEmoji(humidity) {
            if (humidity >= 90) return "";
            if (humidity >= 75) return "";
            if (humidity >= 60) return "";
            if (humidity >= 40) return "";
            return "";
        }

        function populateWeatherSection(data) {
            // Temperature section
            const temps = [
                { value: data.TopTemp1, count: data.TopTemp1Count },
                { value: data.TopTemp2, count: data.TopTemp2Count },
                { value: data.TopTemp3, count: data.TopTemp3Count }
            ].filter(t => t.value !== undefined && t.value !== null);

            const tempItems = document.getElementById('tempItems');
            if (tempItems && temps.length > 0) {
                tempItems.innerHTML = temps.map(t => `
                    <div class="weather-item">
                        <span class="weather-emoji">${getTempEmoji(t.value)}</span>
                        <div class="weather-info">
                            <span class="weather-value">${t.value}C</span>
                            <span class="weather-count"> ${t.count} runs</span>
                        </div>
                    </div>
                `).join('');
            }

            // Weather conditions section
            const conditions = [
                { desc: data.TopWeather1, count: data.TopWeather1Count },
                { desc: data.TopWeather2, count: data.TopWeather2Count },
                { desc: data.TopWeather3, count: data.TopWeather3Count }
            ].filter(c => c.desc);

            const conditionItems = document.getElementById('conditionItems');
            if (conditionItems && conditions.length > 0) {
                conditionItems.innerHTML = conditions.map(c => `
                    <div class="weather-item">
                        <span class="weather-emoji">${getWeatherEmoji(c.desc)}</span>
                        <div class="weather-info">
                            <span class="weather-value">${c.desc}</span>
                            <span class="weather-count"> ${c.count} runs</span>
                        </div>
                    </div>
                `).join('');
            }

            // Humidity section
            const humidity = [
                { value: data.TopHumidity1, count: data.TopHumidity1Count },
                { value: data.TopHumidity2, count: data.TopHumidity2Count },
                { value: data.TopHumidity3, count: data.TopHumidity3Count }
            ].filter(h => h.value !== undefined && h.value !== null);

            const humidityItems = document.getElementById('humidityItems');
            if (humidityItems && humidity.length > 0) {
                humidityItems.innerHTML = humidity.map(h => `
                    <div class="weather-item">
                        <span class="weather-emoji">${getHumidityEmoji(h.value)}</span>
                        <div class="weather-info">
                            <span class="weather-value">${h.value}%</span>
                            <span class="weather-count"> ${h.count} runs</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        function populateShoes(data) {
            const shoesGrid = document.getElementById('shoesGrid');
            if (!shoesGrid) return;

            // Collect shoes data
            const shoes = [];
            for (let i = 1; i <= 6; i++) {
                const name = data[`Shoe${i}Name`];
                const km = data[`Shoe${i}Km`] || 0;
                if (name && name.trim()) {
                    shoes.push({ name: name.trim(), km: parseFloat(km) });
                }
            }

            // Sort by km descending
            shoes.sort((a, b) => b.km - a.km);

            if (shoes.length === 0) {
                shoesGrid.innerHTML = '<p style="color: rgba(255,255,255,0.5); text-align: center;">No shoe data available</p>';
                return;
            }

            const maxKm = shoes[0].km;

            shoesGrid.innerHTML = shoes.map((shoe, index) => {
                const barWidth = maxKm > 0 ? (shoe.km / maxKm) * 100 : 0;
                const rank = index + 1;
                return `
                    <div class="shoe-card">
                        <div class="shoe-rank">#${rank}</div>
                        <div class="shoe-icon"></div>
                        <div class="shoe-info">
                            <div class="shoe-name">${shoe.name}</div>
                        </div>
                        <div class="shoe-bar-container">
                            <div class="shoe-bar" style="width: ${barWidth}%;"></div>
                        </div>
                        <div class="shoe-distance">${shoe.km.toFixed(0)} km</div>
                    </div>
                `;
            }).join('');
        }

        function populatePRBoard(data) {
            const prBoardGrid = document.getElementById('prBoardGrid');
            if (!prBoardGrid) return;

            // Define the PR distances with their data keys
            // Expected data fields: PR400mTime, PR400mPace, PR400mDate, PR1kmTime, etc.
            const prDistances = [
                { distance: '400M', label: '400m', km: 0.4, timeKey: 'PR400mTime', paceKey: 'PR400mPace', dateKey: 'PR400mDate' },
                { distance: '1KM', label: '1km', km: 1, timeKey: 'PR1kmTime', paceKey: 'PR1kmPace', dateKey: 'PR1kmDate' },
                { distance: '5KM', label: '5km', km: 5, timeKey: 'Fastest5kmTime', paceKey: 'Fastest5kmPace', dateKey: 'Fastest5kmDate' },
                { distance: '10KM', label: '10km', km: 10, timeKey: 'Fastest10kmTime', paceKey: 'Fastest10kmPace', dateKey: 'Fastest10kmDate' },
                { distance: '21.1KM', label: 'Half Marathon', km: 21.1, timeKey: 'PRHalfMarathonTime', paceKey: 'PRHalfMarathonPace', dateKey: 'PRHalfMarathonDate' },
                { distance: '42.2KM', label: 'Marathon', km: 42.2, timeKey: 'PRMarathonTime', paceKey: 'PRMarathonPace', dateKey: 'PRMarathonDate' }
            ];

            prBoardGrid.innerHTML = prDistances.map(pr => {
                const time = data[pr.timeKey];
                const pace = data[pr.paceKey];
                const date = data[pr.dateKey];
                const hasData = time && time !== '--:--' && time !== '00:00:00';

                if (hasData) {
                    // Format the time nicely
                    const formattedTime = formatTime(time);
                    // Format pace if available, otherwise calculate it
                    let formattedPace = pace ? formatPace(pace) : '--:--';
                    if (!pace && time) {
                        // Calculate pace from time
                        const timeParts = time.split(':').map(Number);
                        let totalSeconds;
                        if (timeParts.length === 3) {
                            totalSeconds = timeParts[0] * 3600 + timeParts[1] * 60 + timeParts[2];
                        } else {
                            totalSeconds = timeParts[0] * 60 + timeParts[1];
                        }
                        const paceSeconds = totalSeconds / pr.km;
                        const paceMins = Math.floor(paceSeconds / 60);
                        const paceSecs = Math.round(paceSeconds % 60);
                        formattedPace = `${paceMins}:${String(paceSecs).padStart(2, '0')}`;
                    }
                    // Format date if available
                    const formattedDate = date ? formatPRDate(date) : '';

                    return `
                        <div class="pr-card">
                            <div class="pr-card-header">
                                <span class="pr-distance">${pr.distance}</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">${formattedTime}</div>
                            <div class="pr-details">
                                <span class="pr-pace">${formattedPace}/km</span>
                                <span class="pr-date">${formattedDate}</span>
                            </div>
                        </div>
                    `;
                } else {
                    // No data - show as goal
                    return `
                        <div class="pr-card no-data">
                            <div class="pr-card-header">
                                <span class="pr-distance">${pr.distance}</span>
                                <span class="pr-medal"></span>
                            </div>
                            <div class="pr-time">--:--</div>
                            <p class="pr-goal">${pr.label} goal for next year?</p>
                        </div>
                    `;
                }
            }).join('');
        }

        function formatPRDate(dateStr) {
            if (!dateStr) return '';
            try {
                const date = new Date(dateStr);
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
            } catch (e) {
                return dateStr;
            }
        }

        function populateAirtime(data) {
            // Running gait cycle physics:
            // - Cadence is total steps per minute (both feet)
            // - At 170 spm, each foot strikes 85 times/min
            // - Stride cycle = time from one footstrike to next footstrike of SAME foot
            // - Flight phase = time when NEITHER foot is on ground

            // Parse pace - could be seconds (number) or string like "5:30"
            let avgPaceSeconds = 360; // default 6:00/km
            if (data.AveragePace) {
                if (typeof data.AveragePace === 'string' && data.AveragePace.includes(':')) {
                    const parts = data.AveragePace.split(':');
                    avgPaceSeconds = parseInt(parts[0]) * 60 + parseInt(parts[1]);
                } else {
                    avgPaceSeconds = parseFloat(data.AveragePace) || 360;
                }
            }
            const avgPaceMinPerKm = avgPaceSeconds / 60;

            // Estimate GCT based on pace (faster = lower GCT)
            // Research: ~250ms at 6:00/km, ~200ms at 4:00/km, ~300ms at 8:00/km
            const estimatedGCT = Math.min(320, Math.max(180, 130 + (avgPaceMinPerKm * 22))); // ms

            // Calculate cadence - use data if available, otherwise estimate from pace
            let avgCadence = 170; // default (total steps both feet)
            if (data.AvgCadence && !isNaN(data.AvgCadence)) {
                avgCadence = parseFloat(data.AvgCadence);
            } else {
                avgCadence = Math.round(155 + (10 - avgPaceMinPerKm) * 5);
            }
            avgCadence = Math.max(140, Math.min(200, avgCadence)); // clamp to reasonable range

            // Stride cycle time (same foot to same foot) = 2 steps
            // At 170 spm: stride cycle = 60/85 = 706ms
            const strideCycleMs = (60 / (avgCadence / 2)) * 1000;

            // In one stride cycle: 2 ground contacts (one per foot), 2 flight phases
            // Flight phase = (stride cycle - 2 * GCT) / 2
            // This is the true airborne time per step
            const flightPhaseMs = Math.max(0, (strideCycleMs - 2 * estimatedGCT) / 2);

            // Total steps from data (both feet)
            const totalSteps = parseFloat(data.TotalSteps) || 0;

            // Total airtime = flight phase per step * total steps
            // But each stride has 2 steps and 2 flight phases, so it works out
            const totalAirtimeSeconds = (flightPhaseMs * totalSteps) / 1000;

            // For display, use flight phase as "airtime per step"
            const airtimePerStep = flightPhaseMs;

            // Format total airtime
            let totalAirtimeDisplay;
            if (totalAirtimeSeconds >= 3600) {
                const hours = Math.floor(totalAirtimeSeconds / 3600);
                const mins = Math.floor((totalAirtimeSeconds % 3600) / 60);
                totalAirtimeDisplay = `${hours}h ${mins}m`;
            } else if (totalAirtimeSeconds >= 60) {
                const mins = Math.floor(totalAirtimeSeconds / 60);
                const secs = Math.round(totalAirtimeSeconds % 60);
                totalAirtimeDisplay = `${mins}m ${secs}s`;
            } else {
                totalAirtimeDisplay = `${Math.round(totalAirtimeSeconds)}s`;
            }

            // Protect against NaN
            if (isNaN(totalAirtimeSeconds) || totalSteps === 0) {
                totalAirtimeDisplay = '0s';
            }

            // Update DOM with NaN protection
            document.getElementById('totalAirtime').textContent = totalAirtimeDisplay;
            document.getElementById('avgAirtimePerStep').textContent = `${isNaN(airtimePerStep) ? 0 : Math.round(airtimePerStep)}ms`;
            document.getElementById('avgCadence').textContent = `${isNaN(avgCadence) ? 170 : Math.round(avgCadence)} spm`;
            document.getElementById('estGCT').textContent = `${isNaN(estimatedGCT) ? 250 : Math.round(estimatedGCT)}ms`;

            // Fun fact comparisons - show all of them!
            const safeAirtimeSeconds = isNaN(totalAirtimeSeconds) ? 0 : totalAirtimeSeconds;

            // Calculate vertical ascent from airtime using physics
            // h = 0.5 * g * t^2, where t is half the flight phase (going up)
            const tUpSeconds = (flightPhaseMs / 1000) / 2; // half of flight phase in seconds
            const heightPerStepM = 0.5 * 9.8 * tUpSeconds * tUpSeconds; // meters
            const heightPerStepCm = heightPerStepM * 100;

            const totalVerticalM = heightPerStepM * totalSteps;
            const totalVerticalKm = totalVerticalM / 1000;

            let funFactHTML;
            if (safeAirtimeSeconds === 0 || isNaN(totalVerticalM)) {
                funFactHTML = `<p>No airtime data available yet! </p>`;
            } else {
                const burjKhalifas = (totalVerticalM / 828).toFixed(1); // 828m tall
                const everests = (totalVerticalM / 8849).toFixed(2); // 8849m tall
                const jordanDunks = Math.round(safeAirtimeSeconds / 0.92); // MJ hang time ~0.92s

                funFactHTML = `
                    <p> <strong>${burjKhalifas}x</strong> the height of Burj Khalifa</p>
                    <p> <strong>${everests}x</strong> Mount Everest summits</p>
                    <p> <strong>${jordanDunks.toLocaleString()}</strong> Michael Jordan dunks</p>
                `;
            }

            document.getElementById('airtimeFunFact').innerHTML = funFactHTML;
        }

        function populateOutrun(data) {
            // Things to outrun with verified speeds in km/h
            const allCreatures = [
                { name: 'Cheetah', emoji: '', speed: 104, note: 'Top speed burst' },
                { name: 'Lion', emoji: '', speed: 70, note: 'Short distance' },
                { name: 'Hippo', emoji: '', speed: 35, note: 'Surprisingly fast!' },
                { name: 'Crocodile (land)', emoji: '', speed: 15, note: 'Short bursts' },
                { name: 'Elephant', emoji: '', speed: 35, note: 'Charging speed' },
                { name: 'Usain Bolt', emoji: '', speed: 44.72, note: 'World record pace' },
                { name: 'Average Man', emoji: '', speed: 10.6, note: 'Jogging pace' },
                { name: 'Average Woman', emoji: '', speed: 9.2, note: 'Jogging pace' },
                { name: '10 Year Old', emoji: '', speed: 9, note: 'Running pace' },
                { name: 'House Cat', emoji: '', speed: 48, note: 'Top speed' },
                { name: 'Chicken', emoji: '', speed: 14.5, note: 'Full sprint' },
                { name: 'Squirrel', emoji: '', speed: 20, note: 'Dashing away' },
                { name: 'Pig', emoji: '', speed: 17.7, note: 'Domestic pig' },
                { name: 'T-Rex (estimated)', emoji: '', speed: 20, note: 'Scientific estimate' },
                { name: 'Grizzly Bear', emoji: '', speed: 56, note: 'Charging speed' },
                { name: 'Kangaroo', emoji: '', speed: 70, note: 'Hopping speed' },
                { name: 'Black Mamba', emoji: '', speed: 20, note: 'Fastest snake' },
                { name: 'Tortoise', emoji: '', speed: 0.3, note: 'Maximum effort' }
            ];

            // Randomly pick 6 creatures
            const shuffled = allCreatures.sort(() => Math.random() - 0.5);
            const creatures = shuffled.slice(0, 6);

            // Use 5K pace (Fastest5kmTime is in seconds for 5km)
            // Convert to pace per km, then to km/h
            let johnsSpeedKmh = 10; // default
            if (data.Fastest5kmTime) {
                const totalSeconds = parseFloat(data.Fastest5kmTime) || 1500; // default 25 min
                const paceSecondsPerKm = totalSeconds / 5;
                johnsSpeedKmh = 3600 / paceSecondsPerKm;
            }

            // Update pace display
            document.getElementById('outrunPace').textContent = johnsSpeedKmh.toFixed(1) + ' km/h';

            // Sort creatures by speed for better display
            creatures.sort((a, b) => a.speed - b.speed);

            // Generate HTML
            const outrunList = document.getElementById('outrunList');
            outrunList.innerHTML = creatures.map(creature => {
                const canOutrun = johnsSpeedKmh >= creature.speed;
                const closeCall = Math.abs(johnsSpeedKmh - creature.speed) < 2;

                let statusClass, resultText;
                if (canOutrun) {
                    statusClass = closeCall ? 'close-call' : 'can-outrun';
                    resultText = closeCall ? 'BARELY' : 'YES ';
                } else {
                    statusClass = closeCall ? 'close-call' : 'cannot-outrun';
                    resultText = closeCall ? 'CLOSE' : 'NO ';
                }

                return `
                    <div class="outrun-item ${statusClass}">
                        <div class="outrun-emoji">${creature.emoji}</div>
                        <div class="outrun-info">
                            <div class="outrun-name">${creature.name}</div>
                            <div class="outrun-speed">${creature.speed} km/h  ${creature.note}</div>
                        </div>
                        <div class="outrun-result">${resultText}</div>
                    </div>
                `;
            }).join('');
        }

        function populateSweat(data) {
            // Calculate sweat rate based on actual running conditions
            // Base rate + temp factor + humidity multiplier

            // Get weighted average temperature
            let totalTempWeight = 0;
            let weightedTempSum = 0;
            for (let i = 1; i <= 6; i++) {
                const temp = parseFloat(data[`TopTemp${i}`]) || 0;
                const count = parseFloat(data[`TopTemp${i}Count`]) || 0;
                if (temp > 0 && count > 0) {
                    weightedTempSum += temp * count;
                    totalTempWeight += count;
                }
            }
            const avgTemp = totalTempWeight > 0 ? weightedTempSum / totalTempWeight : 25; // default 25C

            // Get weighted average humidity
            let totalHumidityWeight = 0;
            let weightedHumiditySum = 0;
            for (let i = 1; i <= 6; i++) {
                const humidity = parseFloat(data[`TopHumidity${i}`]) || 0;
                const count = parseFloat(data[`TopHumidity${i}Count`]) || 0;
                if (humidity > 0 && count > 0) {
                    weightedHumiditySum += humidity * count;
                    totalHumidityWeight += count;
                }
            }
            const avgHumidity = totalHumidityWeight > 0 ? weightedHumiditySum / totalHumidityWeight : 70; // default 70%

            // Calculate sweat rate:
            // Base: 0.5 L/hr
            // Temp factor: +0.025 L/hr per C above 15C
            // Humidity multiplier: 1.0 at 50%, up to 1.3 at 90%
            // Intensity multiplier: based on pace (6:30/km = 1.0 baseline, faster = more sweat)
            const baseRate = 0.5;
            const tempFactor = Math.max(0, (avgTemp - 15) * 0.025);
            const humidityMultiplier = 1 + ((avgHumidity - 50) / 100) * 0.75; // 50%=1.0, 90%=1.3

            // Intensity factor based on pace
            // Easy pace baseline: 390 sec/km (6:30/km) = 1.0
            // Faster pace = higher intensity = more sweat
            let avgPaceSeconds = 390; // default 6:30/km
            if (data.AveragePace) {
                if (typeof data.AveragePace === 'string' && data.AveragePace.includes(':')) {
                    const parts = data.AveragePace.split(':');
                    avgPaceSeconds = parseInt(parts[0]) * 60 + parseInt(parts[1]);
                } else {
                    avgPaceSeconds = parseFloat(data.AveragePace) || 390;
                }
            }
            // Intensity: 6:30 (390s) = 1.0, 5:00 (300s) = 1.3, 8:00 (480s) = 0.8
            const easyPaceBaseline = 390;
            const intensityMultiplier = Math.max(0.7, Math.min(1.5, easyPaceBaseline / avgPaceSeconds));

            const sweatRatePerHour = (baseRate + tempFactor) * humidityMultiplier * intensityMultiplier;

            const totalHours = parseFloat(data.TotalHours) || 0;
            const totalSweatLitres = totalHours * sweatRatePerHour;

            // Update displays
            document.getElementById('totalSweat').textContent = totalSweatLitres.toFixed(0);

            // Comparisons
            const milkJugs = totalSweatLitres / 2; // 2L jugs
            const bathtubs = totalSweatLitres / 150; // ~150L bathtub
            const fishTanks = totalSweatLitres / 40; // 40L fish tank

            document.getElementById('sweatMilkJugs').textContent = Math.round(milkJugs);
            document.getElementById('sweatBathtubs').textContent = bathtubs.toFixed(1);
            document.getElementById('sweatFishTanks').textContent = fishTanks.toFixed(1);

            // Update the note with actual calculated values
            const paceMin = Math.floor(avgPaceSeconds / 60);
            const paceSec = Math.round(avgPaceSeconds % 60);
            const paceStr = `${paceMin}:${paceSec.toString().padStart(2, '0')}/km`;

            const sweatNote = document.getElementById('sweatNote');
            if (sweatNote) {
                sweatNote.textContent = `* Based on ${avgTemp.toFixed(0)}C, ${avgHumidity.toFixed(0)}% humidity, ${paceStr} pace  ${sweatRatePerHour.toFixed(2)}L/hr`;
            }
        }

        function populatePersona(data) {
            const personaEmoji = document.getElementById('personaEmoji');
            const personaName = document.getElementById('personaName');
            const personaTagline = document.getElementById('personaTagline');
            const personaTraits = document.getElementById('personaTraits');
            const personaDescription = document.getElementById('personaDescription');
            const personaSpiritAnimal = document.getElementById('personaSpiritAnimal');

            // Check if persona data exists
            if (!data.PersonaName) {
                personaEmoji.textContent = '';
                personaName.textContent = 'Persona Pending';
                personaTagline.textContent = 'Check back soon!';
                personaDescription.textContent = 'John\'s running persona for this year hasn\'t been generated yet. Come back later to discover his running personality!';
                personaTraits.innerHTML = '';
                personaSpiritAnimal.textContent = ' Coming soon...';
                return;
            }

            // Populate the persona data
            personaEmoji.textContent = data.Emoji || '';
            personaName.textContent = data.PersonaName || 'Unknown Runner';
            personaTagline.textContent = data.Tagline || '';
            personaDescription.textContent = data.Description || '';

            // Populate traits
            personaTraits.innerHTML = '';
            const traits = [data.Trait1, data.Trait2, data.Trait3].filter(t => t && t.trim());
            traits.forEach(trait => {
                const traitEl = document.createElement('span');
                traitEl.className = 'persona-trait';
                traitEl.textContent = trait;
                personaTraits.appendChild(traitEl);
            });

            // Spirit animal
            personaSpiritAnimal.textContent = data.SpiritAnimal || ' The Lone Wolf';
        }

        function populateActivityGrid(data, year) {
            const grid = document.getElementById('activityGrid');
            const monthsRow = document.getElementById('activityMonths');

            if (!grid) return;

            // Parse daily stats JSON
            let dailyStats = [];
            try {
                dailyStats = typeof data.DailyStatsJSON === 'string'
                    ? JSON.parse(data.DailyStatsJSON)
                    : (data.DailyStatsJSON || []);
            } catch (e) {
                console.error('Failed to parse daily stats:', e);
            }

            // Create a map of date -> {count, distance}
            const statsMap = new Map();
            dailyStats.forEach(d => {
                statsMap.set(d.date, { count: d.count, distance: d.distance });
            });

            // Find max distance for scaling
            const maxDistance = Math.max(...dailyStats.map(d => d.distance), 1);

            // Generate all dates for the year
            const startDate = new Date(year, 0, 1);
            const endDate = new Date(year, 11, 31);
            const today = new Date();
            today.setHours(23, 59, 59, 999); // End of today
            const actualEndDate = endDate > today ? today : endDate;

            // Helper to format date as YYYY-MM-DD in local timezone
            const formatDateLocal = (d) => {
                const yyyy = d.getFullYear();
                const mm = String(d.getMonth() + 1).padStart(2, '0');
                const dd = String(d.getDate()).padStart(2, '0');
                return `${yyyy}-${mm}-${dd}`;
            };

            // Get day of week for Jan 1 (0 = Sunday, 1 = Monday, etc.)
            const startDayOfWeek = startDate.getDay();

            // Build the grid
            grid.innerHTML = '';

            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const monthStartWeeks = []; // Track which week each month starts
            let currentMonth = -1;
            let cellCount = 0;

            // Add empty cells for days before Jan 1 to align the grid
            for (let i = 0; i < startDayOfWeek; i++) {
                const cell = document.createElement('div');
                cell.className = 'activity-cell';
                cell.style.visibility = 'hidden';
                grid.appendChild(cell);
                cellCount++;
            }

            // Track first month position
            monthStartWeeks.push({ month: 0, week: 0 });
            currentMonth = 0;

            let currentDate = new Date(startDate);
            while (currentDate <= actualEndDate) {
                const dateStr = formatDateLocal(currentDate);
                const dayOfWeek = currentDate.getDay();
                const month = currentDate.getMonth();

                // Track when we enter a new month
                if (month !== currentMonth) {
                    const weekNum = Math.floor(cellCount / 7);
                    monthStartWeeks.push({ month: month, week: weekNum });
                    currentMonth = month;
                }

                const stats = statsMap.get(dateStr);
                let level = 0;
                let tooltip = `${dateStr}: No runs`;

                if (stats) {
                    const ratio = stats.distance / maxDistance;
                    if (ratio > 0.75) level = 4;
                    else if (ratio > 0.5) level = 3;
                    else if (ratio > 0.25) level = 2;
                    else level = 1;
                    tooltip = `${dateStr}: ${stats.count} run${stats.count > 1 ? 's' : ''}, ${stats.distance.toFixed(1)}km`;
                }

                const cell = document.createElement('div');
                cell.className = 'activity-cell';
                cell.setAttribute('data-level', level);
                cell.setAttribute('data-tooltip', tooltip);
                grid.appendChild(cell);
                cellCount++;

                currentDate.setDate(currentDate.getDate() + 1);
            }

            // Calculate total weeks in the grid
            const totalWeeks = Math.ceil(cellCount / 7);

            // Get CSS variable values from the slide element
            const getColWidth = () => {
                const slide = document.querySelector('.activity-grid-slide');
                const styles = getComputedStyle(slide);
                const cellSize = parseInt(styles.getPropertyValue('--cell-size')) || 11;
                const cellGap = parseInt(styles.getPropertyValue('--cell-gap')) || 2;
                return cellSize + cellGap;
            };

            // Populate month labels at correct positions
            const positionMonthLabels = () => {
                const colWidth = getColWidth();
                const gridWidth = totalWeeks * colWidth;
                monthsRow.innerHTML = '';
                monthsRow.style.width = gridWidth + 'px';

                monthStartWeeks.forEach(({ month, week }, idx) => {
                    // Skip if this month label would be too close to the next one
                    const nextWeek = monthStartWeeks[idx + 1]?.week;
                    if (nextWeek !== undefined && (nextWeek - week) < 3) {
                        // Skip months that are too close together (less than 3 weeks apart)
                        // But always show first month and last month
                        if (idx !== 0 && idx !== monthStartWeeks.length - 1) {
                            return;
                        }
                    }

                    const span = document.createElement('span');
                    span.textContent = months[month];
                    span.style.left = (week * colWidth) + 'px';
                    monthsRow.appendChild(span);
                });
            };

            positionMonthLabels();

            // Re-position months on resize
            window.addEventListener('resize', positionMonthLabels);

            // Populate stats
            document.getElementById('longestStreak').textContent = data.LongestStreakDays || 0;
            document.getElementById('mostActiveDay').textContent = data.MostActiveDay || '--';
            document.getElementById('weekendRuns').textContent = data.WeekendRuns || 0;
            document.getElementById('weekdayRuns').textContent = data.WeekdayRuns || 0;
        }

        let heatmapMap = null;

        function populateHeatmap(polylinesJson) {
            // Parse the polylines JSON string
            let polylines;
            try {
                polylines = typeof polylinesJson === 'string' ? JSON.parse(polylinesJson) : polylinesJson;
            } catch (e) {
                console.error('Failed to parse polylines:', e);
                return;
            }

            if (!polylines || polylines.length === 0) {
                console.log('No polylines to render');
                return;
            }

            // Townsville bounding box (filter out runs from other cities)
            const TOWNSVILLE_BOUNDS = {
                minLat: -19.45,
                maxLat: -19.15,
                minLng: 146.65,
                maxLng: 146.90
            };

            // Check if a route is within Townsville area
            function isInTownsville(coords) {
                if (coords.length === 0) return false;
                const [lat, lng] = coords[0];
                return lat >= TOWNSVILLE_BOUNDS.minLat && lat <= TOWNSVILLE_BOUNDS.maxLat &&
                       lng >= TOWNSVILLE_BOUNDS.minLng && lng <= TOWNSVILLE_BOUNDS.maxLng;
            }

            // Decode all polylines and collect points
            const allCoords = [];
            const allRoutes = [];
            let totalPoints = 0;

            polylines.forEach(p => {
                if (p.polyline) {
                    const coords = polyline.decode(p.polyline);
                    if (coords.length > 0 && isInTownsville(coords)) {
                        allRoutes.push(coords);
                        allCoords.push(...coords);
                        totalPoints += coords.length;
                    }
                }
            });

            // Update stats
            document.getElementById('routeCount').textContent = allRoutes.length;
            document.getElementById('totalPoints').textContent = formatNumber(totalPoints);

            if (allRoutes.length === 0) return;

            // Initialize map if not already done
            if (heatmapMap) {
                heatmapMap.remove();
            }

            // Centre on Townsville
            heatmapMap = L.map('heatmapMap', {
                zoomControl: false,
                attributionControl: false
            }).setView([-19.26, 146.80], 13);

            // Dark map tiles
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19
            }).addTo(heatmapMap);

            // Add heatmap layer
            L.heatLayer(allCoords, {
                radius: 12,
                blur: 15,
                maxZoom: 17,
                gradient: {
                    0.2: '#00D4FF',
                    0.4: '#39FF14',
                    0.6: '#b967ff',
                    0.8: '#FF2D92',
                    1.0: '#ffffff'
                }
            }).addTo(heatmapMap);

            // Also draw route lines for detail
            allRoutes.forEach(coords => {
                L.polyline(coords, {
                    color: '#39FF14',
                    weight: 1.5,
                    opacity: 0.15
                }).addTo(heatmapMap);
            });

            // Fit map to routes
            if (allCoords.length > 0) {
                const bounds = L.latLngBounds(allCoords);
                heatmapMap.fitBounds(bounds, { padding: [20, 20] });
            }
        }

        // Load data when page loads
        loadRunningData(yearSelect.value);

        // Navigation dots functionality
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.nav-dot');

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const index = Array.from(slides).indexOf(entry.target);
                    dots.forEach((dot, i) => {
                        dot.classList.toggle('active', i === index);
                    });
                }
            });
        }, { threshold: 0.5 });

        slides.forEach(slide => observer.observe(slide));

        dots.forEach(dot => {
            dot.addEventListener('click', () => {
                const slideIndex = parseInt(dot.dataset.slide);
                slides[slideIndex].scrollIntoView({ behavior: 'instant' });
            });
        });

        // Animate numbers when visible
        const animateNumbers = () => {
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(num => {
                const text = num.textContent;
                if (num.dataset.animated) return;
                
                const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting) {
                        num.dataset.animated = true;
                        num.style.opacity = '1';
                    }
                }, { threshold: 0.5 });
                
                observer.observe(num);
            });
        };

        animateNumbers();

        // Add confetti on last slide (persona)
        let confettiTriggered = false;
        const lastSlide = document.querySelector('.persona-slide');

        if (lastSlide) {
            const confettiObserver = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting && !confettiTriggered) {
                    confettiTriggered = true;
                    createConfetti();
                }
            }, { threshold: 0.5 });

            confettiObserver.observe(lastSlide);
        }

        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            if (!container) return;

            const colors = ['#39FF14', '#00D4FF', '#FF2D92', '#FFD700', '#FF6B35', '#00ff88'];
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                        position: fixed;
                        width: ${5 + Math.random() * 10}px;
                        height: ${5 + Math.random() * 10}px;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        left: ${Math.random() * 100}vw;
                        top: -20px;
                        border-radius: ${Math.random() > 0.5 ? '50%' : '2px'};
                        animation: confettiFall ${3 + Math.random() * 2}s ease-out forwards;
                        animation-delay: ${Math.random() * 0.5}s;
                        z-index: 1000;
                    `;
                    container.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 6000);
                }, i * 30);
            }
        }

        // Audio preview player
        let currentAudio = null;
        let currentBtn = null;

        const playIcon = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
        const pauseIcon = '<svg viewBox="0 0 24 24"><path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/></svg>';

        document.querySelectorAll('.play-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const previewUrl = btn.dataset.preview;
                
                // If clicking the same button that's playing, pause it
                if (currentBtn === btn && currentAudio && !currentAudio.paused) {
                    currentAudio.pause();
                    btn.innerHTML = playIcon;
                    btn.classList.remove('playing');
                    return;
                }
                
                // Stop any currently playing audio
                if (currentAudio) {
                    currentAudio.pause();
                    if (currentBtn) {
                        currentBtn.innerHTML = playIcon;
                        currentBtn.classList.remove('playing');
                    }
                }
                
                // Create and play new audio
                currentAudio = new Audio(previewUrl);
                currentBtn = btn;
                
                currentAudio.play();
                btn.innerHTML = pauseIcon;
                btn.classList.add('playing');
                
                // Reset when audio ends
                currentAudio.addEventListener('ended', () => {
                    btn.innerHTML = playIcon;
                    btn.classList.remove('playing');
                });
            });
        });

        // Architecture modal functionality
        const archModal = document.getElementById('archModal');
        const howItWorksBtn = document.getElementById('howItWorksBtn');
        const archModalClose = document.getElementById('archModalClose');

        // Render Mermaid diagram
        const diagramDef = `flowchart TB
    Strava[Strava API] -->|Activities| ADF[Azure Data Factory]
    Spotify[Spotify / Last.fm] -->|Tracks| ADF
    Weather[Open-Meteo API] -->|Weather| ADF
    ADF -->|ETL| DW[(Data Warehouse)]
    DW -->|Run Titles| GPT[OpenAI ChatGPT]
    GPT -->|Awards| DW
    DW -->|Year Stats| GPT
    GPT -->|Persona| DW
    DW -->|Stats| Func[Azure Function]
    Func -->|JSON| Blob[(Blob Storage)]
    Blob -->|Fetch| App[Running Wrapped]
    App -->|Year Review| User((You))

    style Strava fill:#fc4c02,color:#fff
    style Spotify fill:#1db954,color:#fff
    style Weather fill:#ff9500,color:#fff
    style ADF fill:#0078d4,color:#fff
    style DW fill:#00D4FF,color:#000
    style GPT fill:#10a37f,color:#fff
    style Func fill:#0078d4,color:#fff
    style Blob fill:#b967ff,color:#fff
    style App fill:#39FF14,color:#000
    style User fill:#ff71ce,color:#000`;

        mermaid.render('mermaidGraph', diagramDef).then(({svg}) => {
            document.getElementById('mermaidDiagram').innerHTML = svg;
        });

        howItWorksBtn.addEventListener('click', () => {
            archModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        archModalClose.addEventListener('click', () => {
            archModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        // Close modal when clicking outside content
        archModal.addEventListener('click', (e) => {
            if (e.target === archModal) {
                archModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // Close modal with Escape key    // Close modal with Escape key. TESTSTST
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && archModal.classList.contains('active')) {
                archModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
    </script>


</body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>